<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libmoost: /home/mhx/git/github/libmoost/include/moost/timer.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">libmoost
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('timer_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">/home/mhx/git/github/libmoost/include/moost/timer.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="timer_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* vim:set ts=3 sw=3 sts=3 et: */</span>
<a name="l00028"></a>00028 <span class="preprocessor">#ifndef MOOST_TIMER_H__</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#define MOOST_TIMER_H__</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;map&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;boost/shared_ptr.hpp&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;boost/thread/mutex.hpp&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;boost/date_time/posix_time/posix_time.hpp&gt;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="keyword">namespace </span>moost {
<a name="l00038"></a>00038 
<a name="l00042"></a><a class="code" href="classmoost_1_1timer.html">00042</a> <span class="keyword">class </span><a class="code" href="classmoost_1_1timer.html">timer</a>
<a name="l00043"></a>00043 {
<a name="l00044"></a>00044 <span class="keyword">public</span>:
<a name="l00045"></a>00045 
<a name="l00046"></a><a class="code" href="classmoost_1_1timer.html#a794dfdac5e1d07162b29f1bbd1073510">00046</a>    <span class="keyword">typedef</span> std::vector&lt; std::pair&lt;int, boost::posix_time::ptime&gt; &gt; <a class="code" href="classmoost_1_1timer.html#a794dfdac5e1d07162b29f1bbd1073510">threshold_times_type</a>;
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="keyword">private</span>:
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="classmoost_1_1timer.html#a081d748c39abdd2075e8b24e4c334794">00050</a>    boost::mutex <span class="keyword">mutable</span>       <a class="code" href="classmoost_1_1timer.html#a081d748c39abdd2075e8b24e4c334794">m_mutex</a>;
<a name="l00051"></a><a class="code" href="classmoost_1_1timer.html#a51e656f7acefedff1aa8f7e7cf019b8a">00051</a>    std::vector&lt;int&gt;           <a class="code" href="classmoost_1_1timer.html#a51e656f7acefedff1aa8f7e7cf019b8a">m_times</a>;
<a name="l00052"></a><a class="code" href="classmoost_1_1timer.html#a68d1554fa0d58515bd80feee600ac3ee">00052</a>    std::vector&lt;int&gt;::iterator <a class="code" href="classmoost_1_1timer.html#a68d1554fa0d58515bd80feee600ac3ee">m_times_p</a>;
<a name="l00053"></a><a class="code" href="classmoost_1_1timer.html#a8273c63db3dc78815a957a656d220216">00053</a>    std::vector&lt;int&gt;::iterator <a class="code" href="classmoost_1_1timer.html#a8273c63db3dc78815a957a656d220216">m_times_end</a>;
<a name="l00054"></a><a class="code" href="classmoost_1_1timer.html#a295a03dc8765b3e5427a9470a03f186d">00054</a>    <span class="keywordtype">int</span>                        <a class="code" href="classmoost_1_1timer.html#a295a03dc8765b3e5427a9470a03f186d">m_min_time</a>;
<a name="l00055"></a><a class="code" href="classmoost_1_1timer.html#a9334b51f57ebcada017191be1c49cd57">00055</a>    <span class="keywordtype">int</span>                        <a class="code" href="classmoost_1_1timer.html#a9334b51f57ebcada017191be1c49cd57">m_max_time</a>;
<a name="l00056"></a><a class="code" href="classmoost_1_1timer.html#a6f0d241f0ce7643b41d6c3602222f664">00056</a>    <span class="keywordtype">size_t</span>                     <a class="code" href="classmoost_1_1timer.html#a6f0d241f0ce7643b41d6c3602222f664">m_count</a>;
<a name="l00057"></a>00057 
<a name="l00058"></a><a class="code" href="classmoost_1_1timer.html#a0f3b79b0bec74720664bd8dabad58ec4">00058</a>    boost::posix_time::ptime   <a class="code" href="classmoost_1_1timer.html#a0f3b79b0bec74720664bd8dabad58ec4">m_start_time</a>;
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="classmoost_1_1timer.html#abe9741d676ba393c32ce4f6d50953ab3">00060</a>    <span class="keywordtype">int</span>                        <a class="code" href="classmoost_1_1timer.html#abe9741d676ba393c32ce4f6d50953ab3">m_max_threshold_time_ms</a>;
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="classmoost_1_1timer.html#a900e39f6e146062ecd07bee18db79529">00063</a>    <a class="code" href="classmoost_1_1timer.html#a794dfdac5e1d07162b29f1bbd1073510">threshold_times_type</a>           <a class="code" href="classmoost_1_1timer.html#a900e39f6e146062ecd07bee18db79529">m_threshold_times</a>;
<a name="l00064"></a><a class="code" href="classmoost_1_1timer.html#a8b26f8bee2a233070bab7cc05b5c993d">00064</a>    threshold_times_type::iterator <a class="code" href="classmoost_1_1timer.html#a8b26f8bee2a233070bab7cc05b5c993d">m_threshold_times_p</a>;
<a name="l00065"></a><a class="code" href="classmoost_1_1timer.html#a2d5088861baebece036e560d7ed193e7">00065</a>    threshold_times_type::iterator <a class="code" href="classmoost_1_1timer.html#a2d5088861baebece036e560d7ed193e7">m_threshold_times_end</a>;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="keyword">public</span>:
<a name="l00068"></a>00068 
<a name="l00070"></a><a class="code" href="classmoost_1_1timer_1_1scoped__time.html">00070</a>   <span class="keyword">class </span><a class="code" href="classmoost_1_1timer_1_1scoped__time.html" title="used for scoped access to timer">scoped_time</a>
<a name="l00071"></a>00071   {
<a name="l00072"></a>00072   <span class="keyword">private</span>:
<a name="l00073"></a><a class="code" href="classmoost_1_1timer_1_1scoped__time.html#acc15c7d57056108d61ea3909c1acb601">00073</a>     <a class="code" href="classmoost_1_1timer.html">timer</a> &amp;                  <a class="code" href="classmoost_1_1timer_1_1scoped__time.html#acc15c7d57056108d61ea3909c1acb601">m_timer</a>;
<a name="l00074"></a><a class="code" href="classmoost_1_1timer_1_1scoped__time.html#a4451ba1b49137ca6b7a2b43212306629">00074</a>     <span class="keywordtype">bool</span>                     <a class="code" href="classmoost_1_1timer_1_1scoped__time.html#a4451ba1b49137ca6b7a2b43212306629">m_stopped</a>;
<a name="l00075"></a><a class="code" href="classmoost_1_1timer_1_1scoped__time.html#abd4740db741e3325b41d567baf05ebef">00075</a>     boost::posix_time::ptime <a class="code" href="classmoost_1_1timer_1_1scoped__time.html#abd4740db741e3325b41d567baf05ebef">m_time</a>;
<a name="l00076"></a>00076   <span class="keyword">public</span>:
<a name="l00077"></a>00077     <a class="code" href="classmoost_1_1timer_1_1scoped__time.html#af1b05696963dcadb5553d39dc075b71e">scoped_time</a>(<a class="code" href="classmoost_1_1timer.html">timer</a> &amp; timer_);
<a name="l00078"></a>00078     <a class="code" href="classmoost_1_1timer_1_1scoped__time.html#a59fd88b36d746394bab4a4b614b1efae">~scoped_time</a>();
<a name="l00079"></a>00079     <span class="keywordtype">void</span> <a class="code" href="classmoost_1_1timer_1_1scoped__time.html#a5837cbc09c9ce04513f6c72dee990393">stop</a>();
<a name="l00080"></a>00080     boost::posix_time::ptime <a class="code" href="classmoost_1_1timer_1_1scoped__time.html#a598ddb60255eb55ffe0b1549165f2eb6">get_time</a>() <span class="keyword">const</span>;
<a name="l00081"></a>00081   };
<a name="l00082"></a>00082 
<a name="l00086"></a>00086   <a class="code" href="classmoost_1_1timer.html#a721d05747f95f784d3ab76b3803d9dd2">timer</a>(<span class="keywordtype">size_t</span> resolution = 4096, <span class="keywordtype">int</span> max_threshold_time_ms = (std::numeric_limits&lt;int&gt;::max)(), <span class="keywordtype">size_t</span> threshold_resolution = 128);
<a name="l00087"></a>00087 
<a name="l00089"></a>00089   <span class="keywordtype">void</span> <a class="code" href="classmoost_1_1timer.html#af2e3148d473b5f357b384138d9af3df3" title="add a time to the timer">time</a>(<span class="keyword">const</span> boost::posix_time::ptime &amp; start);
<a name="l00090"></a>00090 
<a name="l00092"></a>00092   <span class="keywordtype">int</span> <a class="code" href="classmoost_1_1timer.html#a3602f2bfe7b554131e2bd22709617604" title="get the minimum time recorded">min_time</a>() <span class="keyword">const</span>;
<a name="l00093"></a>00093 
<a name="l00095"></a>00095   <span class="keywordtype">float</span> <a class="code" href="classmoost_1_1timer.html#a53d0a6900b812f1feff7e8d48b0d6e82" title="get the average time recorded">avg_time</a>() <span class="keyword">const</span>;
<a name="l00096"></a>00096 
<a name="l00098"></a>00098   <span class="keywordtype">void</span> <a class="code" href="classmoost_1_1timer.html#af5ae0e743d5532f4ac539c5882e42d5b" title="get the average time and standard deviation">avg_stddev_time</a>(<span class="keywordtype">float</span>&amp; avg, <span class="keywordtype">float</span>&amp; std_dev) <span class="keyword">const</span>;
<a name="l00099"></a>00099 
<a name="l00101"></a>00101   <span class="keywordtype">int</span> <a class="code" href="classmoost_1_1timer.html#aae00a5a6d411005a8f75f83c429d99e4" title="get the median time">median_time</a>() <span class="keyword">const</span>;
<a name="l00102"></a>00102 
<a name="l00104"></a>00104   <span class="keywordtype">int</span> <a class="code" href="classmoost_1_1timer.html#a6a6b9734a5dc0217f053694454c94df8" title="get the maximum time recorded">max_time</a>() <span class="keyword">const</span>;
<a name="l00105"></a>00105 
<a name="l00107"></a>00107   <span class="keywordtype">double</span> <a class="code" href="classmoost_1_1timer.html#a826414f7548834b33c50d92e2842a949" title="get the average number of times per second that times were recorded">count_per_second</a>() <span class="keyword">const</span>;
<a name="l00108"></a>00108 
<a name="l00110"></a>00110   <span class="keywordtype">size_t</span> <a class="code" href="classmoost_1_1timer.html#a9e53ee1b458c7deed35a1ef91d18691f" title="get the count">count</a>() <span class="keyword">const</span>;
<a name="l00111"></a>00111 
<a name="l00112"></a><a class="code" href="classmoost_1_1timer.html#a6d9602c5eb81d25c5312ae12c35d24db">00112</a>   <span class="keywordtype">int</span> <a class="code" href="classmoost_1_1timer.html#a6d9602c5eb81d25c5312ae12c35d24db">get_threshold_time</a>()<span class="keyword"> const</span>
<a name="l00113"></a>00113 <span class="keyword">  </span>{ <span class="keywordflow">return</span> <a class="code" href="classmoost_1_1timer.html#abe9741d676ba393c32ce4f6d50953ab3">m_max_threshold_time_ms</a>; }
<a name="l00114"></a>00114 
<a name="l00116"></a>00116   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ForwardIterator&gt;
<a name="l00117"></a><a class="code" href="classmoost_1_1timer.html#a304071648ec5b4b5e16340e446a66186">00117</a>   <span class="keywordtype">void</span> <a class="code" href="classmoost_1_1timer.html#a304071648ec5b4b5e16340e446a66186" title="get all times">all_times</a>(ForwardIterator out)<span class="keyword"> const</span>
<a name="l00118"></a>00118 <span class="keyword">  </span>{
<a name="l00119"></a>00119      boost::mutex::scoped_lock lock(<a class="code" href="classmoost_1_1timer.html#a081d748c39abdd2075e8b24e4c334794">m_mutex</a>);
<a name="l00120"></a>00120      <span class="keywordflow">for</span> (std::vector&lt;int&gt;::const_iterator it = <a class="code" href="classmoost_1_1timer.html#a51e656f7acefedff1aa8f7e7cf019b8a">m_times</a>.begin(); it != <a class="code" href="classmoost_1_1timer.html#a8273c63db3dc78815a957a656d220216">m_times_end</a>; ++it)
<a name="l00121"></a>00121         *out++ = *it;
<a name="l00122"></a>00122   }
<a name="l00123"></a>00123 
<a name="l00124"></a>00124   <a class="code" href="classmoost_1_1timer.html#a794dfdac5e1d07162b29f1bbd1073510">threshold_times_type</a> <a class="code" href="classmoost_1_1timer.html#ab425df77b7903d4d49a36d85b3b7e1ff">past_threshold_times</a>(<span class="keywordtype">int</span> num) <span class="keyword">const</span>; <span class="comment">// will return the last num entries;</span>
<a name="l00125"></a>00125 
<a name="l00127"></a>00127   <span class="keywordtype">void</span> <a class="code" href="classmoost_1_1timer.html#a66fc54d1f33bd9d4bec5f8d563595c2e" title="reset timing statistics">reset</a>();
<a name="l00128"></a>00128 };
<a name="l00129"></a>00129 
<a name="l00133"></a><a class="code" href="classmoost_1_1multi__timer.html">00133</a> <span class="keyword">class </span><a class="code" href="classmoost_1_1multi__timer.html">multi_timer</a>
<a name="l00134"></a>00134 {
<a name="l00135"></a>00135 <span class="keyword">private</span>:
<a name="l00136"></a>00136 
<a name="l00137"></a><a class="code" href="classmoost_1_1multi__timer.html#a350484083266c294b559f792b45ee8c0">00137</a>   <span class="keywordtype">size_t</span> <a class="code" href="classmoost_1_1multi__timer.html#a350484083266c294b559f792b45ee8c0">m_resolution</a>;
<a name="l00138"></a>00138 
<a name="l00139"></a><a class="code" href="classmoost_1_1multi__timer.html#a9733e2ea5fd526e6009b3ef8304a43c8">00139</a>   boost::mutex <a class="code" href="classmoost_1_1multi__timer.html#a9733e2ea5fd526e6009b3ef8304a43c8">m_mutex</a>;
<a name="l00140"></a>00140   <span class="comment">// map is nice in that inserting doesn&#39;t invalidate any other iterators</span>
<a name="l00141"></a>00141   <span class="comment">// we&#39;ll take advantage of that by passing timers by ref to their scoped locks</span>
<a name="l00142"></a><a class="code" href="classmoost_1_1multi__timer.html#a8a046fb111d6f52fd6160532942cdd37">00142</a>   std::map&lt; std::string, boost::shared_ptr&lt; timer &gt; &gt; <a class="code" href="classmoost_1_1multi__timer.html#a8a046fb111d6f52fd6160532942cdd37">m_timers</a>;
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 <span class="keyword">public</span>:
<a name="l00145"></a>00145 
<a name="l00146"></a><a class="code" href="classmoost_1_1multi__timer.html#a00bbbbd5729f28fb6b31635398e13335">00146</a>   <a class="code" href="classmoost_1_1multi__timer.html#a00bbbbd5729f28fb6b31635398e13335">multi_timer</a>(<span class="keywordtype">size_t</span> resolution = 4096) : <a class="code" href="classmoost_1_1multi__timer.html#a350484083266c294b559f792b45ee8c0">m_resolution</a>(resolution) {}
<a name="l00147"></a>00147 
<a name="l00148"></a><a class="code" href="classmoost_1_1multi__timer.html#a16b076d532bbdaa93e5e6f01a60f4af7">00148</a>   <span class="keyword">typedef</span> std::map&lt; std::string, boost::shared_ptr&lt; timer &gt; &gt;<a class="code" href="classmoost_1_1multi__timer.html#a16b076d532bbdaa93e5e6f01a60f4af7">::iterator</a> <a class="code" href="classmoost_1_1multi__timer.html#a16b076d532bbdaa93e5e6f01a60f4af7">iterator</a>;
<a name="l00149"></a><a class="code" href="classmoost_1_1multi__timer.html#a2b13186cd6e2248a6c628de92a982b99">00149</a>   <span class="keyword">typedef</span> std::map&lt; std::string, boost::shared_ptr&lt; timer &gt; &gt;<a class="code" href="classmoost_1_1multi__timer.html#a2b13186cd6e2248a6c628de92a982b99">::const_iterator</a> <a class="code" href="classmoost_1_1multi__timer.html#a2b13186cd6e2248a6c628de92a982b99">const_iterator</a>;
<a name="l00150"></a>00150 
<a name="l00151"></a><a class="code" href="classmoost_1_1multi__timer_1_1scoped__time.html">00151</a>   <span class="keyword">class </span><a class="code" href="classmoost_1_1multi__timer_1_1scoped__time.html">scoped_time</a> : <span class="keyword">public</span> <a class="code" href="classmoost_1_1timer.html">timer</a>::<a class="code" href="classmoost_1_1multi__timer_1_1scoped__time.html">scoped_time</a>
<a name="l00152"></a>00152   {
<a name="l00153"></a>00153   <span class="keyword">public</span>:
<a name="l00154"></a><a class="code" href="classmoost_1_1multi__timer_1_1scoped__time.html#af8047365fff056fc1f173fc05084d014">00154</a>     <a class="code" href="classmoost_1_1multi__timer_1_1scoped__time.html#af8047365fff056fc1f173fc05084d014">scoped_time</a>( <a class="code" href="classmoost_1_1multi__timer.html">multi_timer</a> &amp; mt,
<a name="l00155"></a>00155                  <span class="keyword">const</span> std::string &amp; name,
<a name="l00156"></a>00156                  <span class="keywordtype">int</span> max_threshold_time_ms = (std::numeric_limits&lt;int&gt;::max)() )
<a name="l00157"></a>00157       : <a class="code" href="classmoost_1_1timer.html">timer</a>::<a class="code" href="classmoost_1_1multi__timer_1_1scoped__time.html">scoped_time</a>( mt(name, max_threshold_time_ms) ) {}
<a name="l00158"></a>00158   };
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html">00160</a>   <span class="keyword">class </span><a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html">reassignable_scoped_time</a>
<a name="l00161"></a>00161   {
<a name="l00162"></a>00162   <span class="keyword">public</span>:
<a name="l00163"></a>00163      <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#a75d0abe44f6bb53a9b31ee3c4907b9bb">reassignable_scoped_time</a>( <a class="code" href="classmoost_1_1multi__timer.html">multi_timer</a> &amp; mt, <span class="keyword">const</span> std::string &amp; name, <span class="keywordtype">int</span> max_threshold_time_ms = (std::numeric_limits&lt;int&gt;::max)());
<a name="l00164"></a>00164      <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#a04ba34695654e039de525c852752cb2a">~reassignable_scoped_time</a>();
<a name="l00165"></a>00165 
<a name="l00166"></a>00166      <span class="keywordtype">void</span> <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#a78f46cd8ad109ba04ebb462b153fe7d1">reassign</a>(<span class="keyword">const</span> std::string&amp; name);
<a name="l00167"></a>00167      <span class="keywordtype">void</span> <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#ac8bef4622e9badf16523b6b1fd55b830">stop</a>();
<a name="l00168"></a>00168      <span class="keywordtype">void</span> <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#a1f930b8d02c9a8633fec3dc450721626">discard</a>();
<a name="l00169"></a>00169      boost::posix_time::ptime <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#a2ee103931db0478d4259bd5e14b11699">get_time</a>() <span class="keyword">const</span>;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171   <span class="keyword">private</span>:
<a name="l00172"></a>00172 
<a name="l00173"></a><a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#a3d9cf081f7e62b7547e16dd13675ae0f">00173</a>      <a class="code" href="classmoost_1_1multi__timer.html">multi_timer</a>&amp;             <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#a3d9cf081f7e62b7547e16dd13675ae0f">m_multi_timer</a>;
<a name="l00174"></a><a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#afc4e3a1c5c648cfdeabbb043b503a1fa">00174</a>      boost::shared_ptr&lt;timer&gt; <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#afc4e3a1c5c648cfdeabbb043b503a1fa">m_timer</a>;
<a name="l00175"></a><a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#ae7e375283bad65584cdc54adf96adbcd">00175</a>      <span class="keywordtype">bool</span>                     <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#ae7e375283bad65584cdc54adf96adbcd">m_stopped</a>;
<a name="l00176"></a><a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#ae72097a4249d5ce6cb959abf7cbdb5da">00176</a>      boost::posix_time::ptime <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#ae72097a4249d5ce6cb959abf7cbdb5da">m_time</a>;
<a name="l00177"></a><a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#a50076bc13800811d3f9a5fe4bb0d41bf">00177</a>      boost::mutex             <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#a50076bc13800811d3f9a5fe4bb0d41bf">m_reassign_mutex</a>;
<a name="l00178"></a><a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#a3cdc2a7d8dd5b29df9de7665a2b0ae08">00178</a>      <span class="keywordtype">int</span>                      <a class="code" href="classmoost_1_1multi__timer_1_1reassignable__scoped__time.html#a3cdc2a7d8dd5b29df9de7665a2b0ae08">m_max_threshold_time_ms</a>;
<a name="l00179"></a>00179   };
<a name="l00180"></a>00180 
<a name="l00181"></a>00181 
<a name="l00182"></a><a class="code" href="classmoost_1_1multi__timer.html#a27205629e404420ece4c378490d3ceb1">00182</a>   <a class="code" href="classmoost_1_1timer.html">timer</a> &amp; <a class="code" href="classmoost_1_1multi__timer.html#a27205629e404420ece4c378490d3ceb1">operator[]</a>(<span class="keyword">const</span> std::string &amp; name)
<a name="l00183"></a>00183   {
<a name="l00184"></a>00184     boost::mutex::scoped_lock lock(<a class="code" href="classmoost_1_1multi__timer.html#a9733e2ea5fd526e6009b3ef8304a43c8">m_mutex</a>);
<a name="l00185"></a>00185     boost::shared_ptr&lt; timer &gt; &amp; ptimer = <a class="code" href="classmoost_1_1multi__timer.html#a8a046fb111d6f52fd6160532942cdd37">m_timers</a>[name];
<a name="l00186"></a>00186     <span class="keywordflow">if</span> (!ptimer)
<a name="l00187"></a>00187       ptimer.reset(<span class="keyword">new</span> <a class="code" href="classmoost_1_1timer.html">timer</a>(<a class="code" href="classmoost_1_1multi__timer.html#a350484083266c294b559f792b45ee8c0">m_resolution</a>));
<a name="l00188"></a>00188     <span class="keywordflow">return</span> *ptimer;
<a name="l00189"></a>00189   }
<a name="l00190"></a>00190 
<a name="l00191"></a><a class="code" href="classmoost_1_1multi__timer.html#a7faa27053a91f6a96665b2173fea95e5">00191</a>   <a class="code" href="classmoost_1_1timer.html">timer</a> &amp; <a class="code" href="classmoost_1_1multi__timer.html#a7faa27053a91f6a96665b2173fea95e5">operator()</a>(<span class="keyword">const</span> std::string &amp; name, <span class="keywordtype">int</span> max_threshold_time_ms)
<a name="l00192"></a>00192   {
<a name="l00193"></a>00193      boost::mutex::scoped_lock lock(<a class="code" href="classmoost_1_1multi__timer.html#a9733e2ea5fd526e6009b3ef8304a43c8">m_mutex</a>);
<a name="l00194"></a>00194      boost::shared_ptr&lt; timer &gt; &amp; ptimer = <a class="code" href="classmoost_1_1multi__timer.html#a8a046fb111d6f52fd6160532942cdd37">m_timers</a>[name];
<a name="l00195"></a>00195      <span class="keywordflow">if</span> (!ptimer)
<a name="l00196"></a>00196         ptimer.reset(<span class="keyword">new</span> <a class="code" href="classmoost_1_1timer.html">timer</a>(<a class="code" href="classmoost_1_1multi__timer.html#a350484083266c294b559f792b45ee8c0">m_resolution</a>, max_threshold_time_ms));
<a name="l00197"></a>00197      <span class="keywordflow">return</span> *ptimer;
<a name="l00198"></a>00198   }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200   <span class="comment">// grab this before iterating over the collection</span>
<a name="l00201"></a><a class="code" href="classmoost_1_1multi__timer.html#a18b74dd407611626867f38cfa83866ff">00201</a>   boost::mutex &amp; <a class="code" href="classmoost_1_1multi__timer.html#a18b74dd407611626867f38cfa83866ff">mutex</a>() { <span class="keywordflow">return</span> <a class="code" href="classmoost_1_1multi__timer.html#a9733e2ea5fd526e6009b3ef8304a43c8">m_mutex</a>; }
<a name="l00202"></a>00202 
<a name="l00203"></a>00203   <span class="comment">// iterators:</span>
<a name="l00204"></a><a class="code" href="classmoost_1_1multi__timer.html#ae5759cd511550d808b3ac3b94080e32d">00204</a>   <a class="code" href="classmoost_1_1multi__timer.html#a16b076d532bbdaa93e5e6f01a60f4af7">iterator</a> <a class="code" href="classmoost_1_1multi__timer.html#ae5759cd511550d808b3ac3b94080e32d">begin</a>() { <span class="keywordflow">return</span> <a class="code" href="classmoost_1_1multi__timer.html#a8a046fb111d6f52fd6160532942cdd37">m_timers</a>.begin(); }
<a name="l00205"></a><a class="code" href="classmoost_1_1multi__timer.html#a0a3df6f63671e5300dad1101599e108f">00205</a>   <a class="code" href="classmoost_1_1multi__timer.html#a16b076d532bbdaa93e5e6f01a60f4af7">iterator</a> <a class="code" href="classmoost_1_1multi__timer.html#a0a3df6f63671e5300dad1101599e108f">end</a>() { <span class="keywordflow">return</span> <a class="code" href="classmoost_1_1multi__timer.html#a8a046fb111d6f52fd6160532942cdd37">m_timers</a>.end(); }
<a name="l00206"></a><a class="code" href="classmoost_1_1multi__timer.html#a80a7bdac0fab5c911a03ef082fa61d19">00206</a>   <a class="code" href="classmoost_1_1multi__timer.html#a2b13186cd6e2248a6c628de92a982b99">const_iterator</a> <a class="code" href="classmoost_1_1multi__timer.html#a80a7bdac0fab5c911a03ef082fa61d19">begin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmoost_1_1multi__timer.html#a8a046fb111d6f52fd6160532942cdd37">m_timers</a>.begin(); }
<a name="l00207"></a><a class="code" href="classmoost_1_1multi__timer.html#a260f823df7080dfa432f8d2578f5dc3f">00207</a>   <a class="code" href="classmoost_1_1multi__timer.html#a2b13186cd6e2248a6c628de92a982b99">const_iterator</a> <a class="code" href="classmoost_1_1multi__timer.html#a260f823df7080dfa432f8d2578f5dc3f">end</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmoost_1_1multi__timer.html#a8a046fb111d6f52fd6160532942cdd37">m_timers</a>.end(); }
<a name="l00208"></a>00208 };
<a name="l00209"></a>00209 
<a name="l00210"></a>00210 } <span class="comment">// moost</span>
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="preprocessor">#endif // MOOST_TIMER_H__</span>
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="timer_8h.html">timer.h</a>      </li>

    <li class="footer">Generated on Wed Feb 20 2013 05:56:08 for libmoost by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
