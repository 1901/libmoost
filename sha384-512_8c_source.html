<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libmoost: /home/mhx/git/github/libmoost/src/digest/rfc6234/sha384-512.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">libmoost
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('sha384-512_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">/home/mhx/git/github/libmoost/src/digest/rfc6234/sha384-512.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="sha384-512_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/************************* sha384-512.c ************************/</span>
<a name="l00002"></a>00002 <span class="comment">/***************** See RFC 6234 for details. *******************/</span>
<a name="l00003"></a>00003 <span class="comment">/* Copyright (c) 2011 IETF Trust and the persons identified as */</span>
<a name="l00004"></a>00004 <span class="comment">/* authors of the code.  All rights reserved.                  */</span>
<a name="l00005"></a>00005 <span class="comment">/* See sha.h for terms of use and redistribution.              */</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="comment">/*</span>
<a name="l00008"></a>00008 <span class="comment"> * Description:</span>
<a name="l00009"></a>00009 <span class="comment"> *   This file implements the Secure Hash Algorithms SHA-384 and</span>
<a name="l00010"></a>00010 <span class="comment"> *   SHA-512 as defined in the U.S. National Institute of Standards</span>
<a name="l00011"></a>00011 <span class="comment"> *   and Technology Federal Information Processing Standards</span>
<a name="l00012"></a>00012 <span class="comment"> *   Publication (FIPS PUB) 180-3 published in October 2008</span>
<a name="l00013"></a>00013 <span class="comment"> *   and formerly defined in its predecessors, FIPS PUB 180-1</span>
<a name="l00014"></a>00014 <span class="comment"> *   and FIP PUB 180-2.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> *   A combined document showing all algorithms is available at</span>
<a name="l00017"></a>00017 <span class="comment"> *       http://csrc.nist.gov/publications/fips/</span>
<a name="l00018"></a>00018 <span class="comment"> *              fips180-3/fips180-3_final.pdf</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> *   The SHA-384 and SHA-512 algorithms produce 384-bit and 512-bit</span>
<a name="l00021"></a>00021 <span class="comment"> *   message digests for a given data stream.  It should take about</span>
<a name="l00022"></a>00022 <span class="comment"> *   2**n steps to find a message with the same digest as a given</span>
<a name="l00023"></a>00023 <span class="comment"> *   message and 2**(n/2) to find any two messages with the same</span>
<a name="l00024"></a>00024 <span class="comment"> *   digest, when n is the digest size in bits.  Therefore, this</span>
<a name="l00025"></a>00025 <span class="comment"> *   algorithm can serve as a means of providing a</span>
<a name="l00026"></a>00026 <span class="comment"> *   &quot;fingerprint&quot; for a message.</span>
<a name="l00027"></a>00027 <span class="comment"> *</span>
<a name="l00028"></a>00028 <span class="comment"> * Portability Issues:</span>
<a name="l00029"></a>00029 <span class="comment"> *   SHA-384 and SHA-512 are defined in terms of 64-bit &quot;words&quot;,</span>
<a name="l00030"></a>00030 <span class="comment"> *   but if USE_32BIT_ONLY is #defined, this code is implemented in</span>
<a name="l00031"></a>00031 <span class="comment"> *   terms of 32-bit &quot;words&quot;.  This code uses &lt;stdint.h&gt; (included</span>
<a name="l00032"></a>00032 <span class="comment"> *   via &quot;sha.h&quot;) to define the 64-, 32- and 8-bit unsigned integer</span>
<a name="l00033"></a>00033 <span class="comment"> *   types.  If your C compiler does not support 64-bit unsigned</span>
<a name="l00034"></a>00034 <span class="comment"> *   integers and you do not #define USE_32BIT_ONLY, this code is</span>
<a name="l00035"></a>00035 <span class="comment"> *   not appropriate.</span>
<a name="l00036"></a>00036 <span class="comment"> *</span>
<a name="l00037"></a>00037 <span class="comment"> * Caveats:</span>
<a name="l00038"></a>00038 <span class="comment"> *   SHA-384 and SHA-512 are designed to work with messages less</span>
<a name="l00039"></a>00039 <span class="comment"> *   than 2^128 bits long.  This implementation uses SHA384/512Input()</span>
<a name="l00040"></a>00040 <span class="comment"> *   to hash the bits that are a multiple of the size of an 8-bit</span>
<a name="l00041"></a>00041 <span class="comment"> *   octet, and then optionally uses SHA384/256FinalBits()</span>
<a name="l00042"></a>00042 <span class="comment"> *   to hash the final few bits of the input.</span>
<a name="l00043"></a>00043 <span class="comment"> *</span>
<a name="l00044"></a>00044 <span class="comment"> */</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="sha_8h.html">sha.h</a>&quot;</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#ifdef USE_32BIT_ONLY</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span><span class="comment">/*</span>
<a name="l00050"></a>00050 <span class="comment"> * Define 64-bit arithmetic in terms of 32-bit arithmetic.</span>
<a name="l00051"></a>00051 <span class="comment"> * Each 64-bit number is represented in a 2-word array.</span>
<a name="l00052"></a>00052 <span class="comment"> * All macros are defined such that the result is the last parameter.</span>
<a name="l00053"></a>00053 <span class="comment"> */</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="comment">/*</span>
<a name="l00056"></a>00056 <span class="comment"> * Define shift, rotate left, and rotate right functions</span>
<a name="l00057"></a>00057 <span class="comment"> */</span>
<a name="l00058"></a>00058 <span class="preprocessor">#define SHA512_SHR(bits, word, ret) (                          \</span>
<a name="l00059"></a>00059 <span class="preprocessor">    </span><span class="comment">/* (((uint64_t)((word))) &gt;&gt; (bits)) */</span>                     \
<a name="l00060"></a>00060     (ret)[0] = (((bits) &lt; 32) &amp;&amp; ((bits) &gt;= 0)) ?              \
<a name="l00061"></a>00061       ((word)[0] &gt;&gt; (bits)) : 0,                               \
<a name="l00062"></a>00062     (ret)[1] = ((bits) &gt; 32) ? ((word)[0] &gt;&gt; ((bits) - 32)) :  \
<a name="l00063"></a>00063       ((bits) == 32) ? (word)[0] :                             \
<a name="l00064"></a>00064       ((bits) &gt;= 0) ?                                          \
<a name="l00065"></a>00065         (((word)[0] &lt;&lt; (32 - (bits))) |                        \
<a name="l00066"></a>00066         ((word)[1] &gt;&gt; (bits))) : 0 )
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="preprocessor">#define SHA512_SHL(bits, word, ret) (                          \</span>
<a name="l00069"></a>00069 <span class="preprocessor">    </span><span class="comment">/* (((uint64_t)(word)) &lt;&lt; (bits)) */</span>                       \
<a name="l00070"></a>00070     (ret)[0] = ((bits) &gt; 32) ? ((word)[1] &lt;&lt; ((bits) - 32)) :  \
<a name="l00071"></a>00071          ((bits) == 32) ? (word)[1] :                          \
<a name="l00072"></a>00072          ((bits) &gt;= 0) ?                                       \
<a name="l00073"></a>00073            (((word)[0] &lt;&lt; (bits)) |                            \
<a name="l00074"></a>00074            ((word)[1] &gt;&gt; (32 - (bits)))) :                     \
<a name="l00075"></a>00075          0,                                                    \
<a name="l00076"></a>00076     (ret)[1] = (((bits) &lt; 32) &amp;&amp; ((bits) &gt;= 0)) ?              \
<a name="l00077"></a>00077         ((word)[1] &lt;&lt; (bits)) : 0 )
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="comment">/*</span>
<a name="l00080"></a>00080 <span class="comment"> * Define 64-bit OR</span>
<a name="l00081"></a>00081 <span class="comment"> */</span>
<a name="l00082"></a>00082 <span class="preprocessor">#define SHA512_OR(word1, word2, ret) (                         \</span>
<a name="l00083"></a>00083 <span class="preprocessor">    (ret)[0] = (word1)[0] | (word2)[0],                        \</span>
<a name="l00084"></a>00084 <span class="preprocessor">    (ret)[1] = (word1)[1] | (word2)[1] )</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span>
<a name="l00086"></a>00086 <span class="comment">/*</span>
<a name="l00087"></a>00087 <span class="comment"> * Define 64-bit XOR</span>
<a name="l00088"></a>00088 <span class="comment"> */</span>
<a name="l00089"></a>00089 <span class="preprocessor">#define SHA512_XOR(word1, word2, ret) (                        \</span>
<a name="l00090"></a>00090 <span class="preprocessor">    (ret)[0] = (word1)[0] ^ (word2)[0],                        \</span>
<a name="l00091"></a>00091 <span class="preprocessor">    (ret)[1] = (word1)[1] ^ (word2)[1] )</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span>
<a name="l00093"></a>00093 <span class="comment">/*</span>
<a name="l00094"></a>00094 <span class="comment"> * Define 64-bit AND</span>
<a name="l00095"></a>00095 <span class="comment"> */</span>
<a name="l00096"></a>00096 <span class="preprocessor">#define SHA512_AND(word1, word2, ret) (                        \</span>
<a name="l00097"></a>00097 <span class="preprocessor">    (ret)[0] = (word1)[0] &amp; (word2)[0],                        \</span>
<a name="l00098"></a>00098 <span class="preprocessor">    (ret)[1] = (word1)[1] &amp; (word2)[1] )</span>
<a name="l00099"></a>00099 <span class="preprocessor"></span>
<a name="l00100"></a>00100 <span class="comment">/*</span>
<a name="l00101"></a>00101 <span class="comment"> * Define 64-bit TILDA</span>
<a name="l00102"></a>00102 <span class="comment"> */</span>
<a name="l00103"></a>00103 <span class="preprocessor">#define SHA512_TILDA(word, ret)                                \</span>
<a name="l00104"></a>00104 <span class="preprocessor">  ( (ret)[0] = ~(word)[0], (ret)[1] = ~(word)[1] )</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span>
<a name="l00106"></a>00106 <span class="comment">/*</span>
<a name="l00107"></a>00107 <span class="comment"> * Define 64-bit ADD</span>
<a name="l00108"></a>00108 <span class="comment"> */</span>
<a name="l00109"></a>00109 <span class="preprocessor">#define SHA512_ADD(word1, word2, ret) (                        \</span>
<a name="l00110"></a>00110 <span class="preprocessor">    (ret)[1] = (word1)[1], (ret)[1] += (word2)[1],             \</span>
<a name="l00111"></a>00111 <span class="preprocessor">    (ret)[0] = (word1)[0] + (word2)[0] + ((ret)[1] &lt; (word1)[1]) )</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span>
<a name="l00113"></a>00113 <span class="comment">/*</span>
<a name="l00114"></a>00114 <span class="comment"> * Add the 4word value in word2 to word1.</span>
<a name="l00115"></a>00115 <span class="comment"> */</span>
<a name="l00116"></a>00116 <span class="keyword">static</span> uint32_t ADDTO4_temp, ADDTO4_temp2;
<a name="l00117"></a>00117 <span class="preprocessor">#define SHA512_ADDTO4(word1, word2) (                          \</span>
<a name="l00118"></a>00118 <span class="preprocessor">    ADDTO4_temp = (word1)[3],                                  \</span>
<a name="l00119"></a>00119 <span class="preprocessor">    (word1)[3] += (word2)[3],                                  \</span>
<a name="l00120"></a>00120 <span class="preprocessor">    ADDTO4_temp2 = (word1)[2],                                 \</span>
<a name="l00121"></a>00121 <span class="preprocessor">    (word1)[2] += (word2)[2] + ((word1)[3] &lt; ADDTO4_temp),     \</span>
<a name="l00122"></a>00122 <span class="preprocessor">    ADDTO4_temp = (word1)[1],                                  \</span>
<a name="l00123"></a>00123 <span class="preprocessor">    (word1)[1] += (word2)[1] + ((word1)[2] &lt; ADDTO4_temp2),    \</span>
<a name="l00124"></a>00124 <span class="preprocessor">    (word1)[0] += (word2)[0] + ((word1)[1] &lt; ADDTO4_temp) )</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span>
<a name="l00126"></a>00126 <span class="comment">/*</span>
<a name="l00127"></a>00127 <span class="comment"> * Add the 2word value in word2 to word1.</span>
<a name="l00128"></a>00128 <span class="comment"> */</span>
<a name="l00129"></a>00129 <span class="keyword">static</span> uint32_t ADDTO2_temp;
<a name="l00130"></a>00130 <span class="preprocessor">#define SHA512_ADDTO2(word1, word2) (                          \</span>
<a name="l00131"></a>00131 <span class="preprocessor">    ADDTO2_temp = (word1)[1],                                  \</span>
<a name="l00132"></a>00132 <span class="preprocessor">    (word1)[1] += (word2)[1],                                  \</span>
<a name="l00133"></a>00133 <span class="preprocessor">    (word1)[0] += (word2)[0] + ((word1)[1] &lt; ADDTO2_temp) )</span>
<a name="l00134"></a>00134 <span class="preprocessor"></span>
<a name="l00135"></a>00135 <span class="comment">/*</span>
<a name="l00136"></a>00136 <span class="comment"> * SHA rotate   ((word &gt;&gt; bits) | (word &lt;&lt; (64-bits)))</span>
<a name="l00137"></a>00137 <span class="comment"> */</span>
<a name="l00138"></a>00138 <span class="keyword">static</span> uint32_t ROTR_temp1[2], ROTR_temp2[2];
<a name="l00139"></a>00139 <span class="preprocessor">#define SHA512_ROTR(bits, word, ret) (                         \</span>
<a name="l00140"></a>00140 <span class="preprocessor">    SHA512_SHR((bits), (word), ROTR_temp1),                    \</span>
<a name="l00141"></a>00141 <span class="preprocessor">    SHA512_SHL(64-(bits), (word), ROTR_temp2),                 \</span>
<a name="l00142"></a>00142 <span class="preprocessor">    SHA512_OR(ROTR_temp1, ROTR_temp2, (ret)) )</span>
<a name="l00143"></a>00143 <span class="preprocessor"></span>
<a name="l00144"></a>00144 <span class="comment">/*</span>
<a name="l00145"></a>00145 <span class="comment"> * Define the SHA SIGMA and sigma macros</span>
<a name="l00146"></a>00146 <span class="comment"> *</span>
<a name="l00147"></a>00147 <span class="comment"> *  SHA512_ROTR(28,word) ^ SHA512_ROTR(34,word) ^ SHA512_ROTR(39,word)</span>
<a name="l00148"></a>00148 <span class="comment"> */</span>
<a name="l00149"></a>00149 <span class="keyword">static</span> uint32_t SIGMA0_temp1[2], SIGMA0_temp2[2],
<a name="l00150"></a>00150   SIGMA0_temp3[2], SIGMA0_temp4[2];
<a name="l00151"></a>00151 <span class="preprocessor">#define SHA512_SIGMA0(word, ret) (                             \</span>
<a name="l00152"></a>00152 <span class="preprocessor">    SHA512_ROTR(28, (word), SIGMA0_temp1),                     \</span>
<a name="l00153"></a>00153 <span class="preprocessor">    SHA512_ROTR(34, (word), SIGMA0_temp2),                     \</span>
<a name="l00154"></a>00154 <span class="preprocessor">    SHA512_ROTR(39, (word), SIGMA0_temp3),                     \</span>
<a name="l00155"></a>00155 <span class="preprocessor">    SHA512_XOR(SIGMA0_temp2, SIGMA0_temp3, SIGMA0_temp4),      \</span>
<a name="l00156"></a>00156 <span class="preprocessor">    SHA512_XOR(SIGMA0_temp1, SIGMA0_temp4, (ret)) )</span>
<a name="l00157"></a>00157 <span class="preprocessor"></span>
<a name="l00158"></a>00158 <span class="comment">/*</span>
<a name="l00159"></a>00159 <span class="comment"> * SHA512_ROTR(14,word) ^ SHA512_ROTR(18,word) ^ SHA512_ROTR(41,word)</span>
<a name="l00160"></a>00160 <span class="comment"> */</span>
<a name="l00161"></a>00161 <span class="keyword">static</span> uint32_t SIGMA1_temp1[2], SIGMA1_temp2[2],
<a name="l00162"></a>00162   SIGMA1_temp3[2], SIGMA1_temp4[2];
<a name="l00163"></a>00163 <span class="preprocessor">#define SHA512_SIGMA1(word, ret) (                             \</span>
<a name="l00164"></a>00164 <span class="preprocessor">    SHA512_ROTR(14, (word), SIGMA1_temp1),                     \</span>
<a name="l00165"></a>00165 <span class="preprocessor">    SHA512_ROTR(18, (word), SIGMA1_temp2),                     \</span>
<a name="l00166"></a>00166 <span class="preprocessor">    SHA512_ROTR(41, (word), SIGMA1_temp3),                     \</span>
<a name="l00167"></a>00167 <span class="preprocessor">    SHA512_XOR(SIGMA1_temp2, SIGMA1_temp3, SIGMA1_temp4),      \</span>
<a name="l00168"></a>00168 <span class="preprocessor">    SHA512_XOR(SIGMA1_temp1, SIGMA1_temp4, (ret)) )</span>
<a name="l00169"></a>00169 <span class="preprocessor"></span>
<a name="l00170"></a>00170 <span class="comment">/*</span>
<a name="l00171"></a>00171 <span class="comment"> * (SHA512_ROTR( 1,word) ^ SHA512_ROTR( 8,word) ^ SHA512_SHR( 7,word))</span>
<a name="l00172"></a>00172 <span class="comment"> */</span>
<a name="l00173"></a>00173 <span class="keyword">static</span> uint32_t sigma0_temp1[2], sigma0_temp2[2],
<a name="l00174"></a>00174   sigma0_temp3[2], sigma0_temp4[2];
<a name="l00175"></a>00175 <span class="preprocessor">#define SHA512_sigma0(word, ret) (                             \</span>
<a name="l00176"></a>00176 <span class="preprocessor">    SHA512_ROTR( 1, (word), sigma0_temp1),                     \</span>
<a name="l00177"></a>00177 <span class="preprocessor">    SHA512_ROTR( 8, (word), sigma0_temp2),                     \</span>
<a name="l00178"></a>00178 <span class="preprocessor">    SHA512_SHR( 7, (word), sigma0_temp3),                      \</span>
<a name="l00179"></a>00179 <span class="preprocessor">    SHA512_XOR(sigma0_temp2, sigma0_temp3, sigma0_temp4),      \</span>
<a name="l00180"></a>00180 <span class="preprocessor">    SHA512_XOR(sigma0_temp1, sigma0_temp4, (ret)) )</span>
<a name="l00181"></a>00181 <span class="preprocessor"></span>
<a name="l00182"></a>00182 <span class="comment">/*</span>
<a name="l00183"></a>00183 <span class="comment"> * (SHA512_ROTR(19,word) ^ SHA512_ROTR(61,word) ^ SHA512_SHR( 6,word))</span>
<a name="l00184"></a>00184 <span class="comment"> */</span>
<a name="l00185"></a>00185 <span class="keyword">static</span> uint32_t sigma1_temp1[2], sigma1_temp2[2],
<a name="l00186"></a>00186   sigma1_temp3[2], sigma1_temp4[2];
<a name="l00187"></a>00187 <span class="preprocessor">#define SHA512_sigma1(word, ret) (                             \</span>
<a name="l00188"></a>00188 <span class="preprocessor">    SHA512_ROTR(19, (word), sigma1_temp1),                     \</span>
<a name="l00189"></a>00189 <span class="preprocessor">    SHA512_ROTR(61, (word), sigma1_temp2),                     \</span>
<a name="l00190"></a>00190 <span class="preprocessor">    SHA512_SHR( 6, (word), sigma1_temp3),                      \</span>
<a name="l00191"></a>00191 <span class="preprocessor">    SHA512_XOR(sigma1_temp2, sigma1_temp3, sigma1_temp4),      \</span>
<a name="l00192"></a>00192 <span class="preprocessor">    SHA512_XOR(sigma1_temp1, sigma1_temp4, (ret)) )</span>
<a name="l00193"></a>00193 <span class="preprocessor"></span>
<a name="l00194"></a>00194 <span class="preprocessor">#ifndef USE_MODIFIED_MACROS</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span><span class="comment">/*</span>
<a name="l00196"></a>00196 <span class="comment"> * These definitions are the ones used in FIPS 180-3, section 4.1.3</span>
<a name="l00197"></a>00197 <span class="comment"> *  Ch(x,y,z)   ((x &amp; y) ^ (~x &amp; z))</span>
<a name="l00198"></a>00198 <span class="comment"> */</span>
<a name="l00199"></a>00199 <span class="keyword">static</span> uint32_t Ch_temp1[2], Ch_temp2[2], Ch_temp3[2];
<a name="l00200"></a>00200 <span class="preprocessor">#define SHA_Ch(x, y, z, ret) (                                 \</span>
<a name="l00201"></a>00201 <span class="preprocessor">    SHA512_AND(x, y, Ch_temp1),                                \</span>
<a name="l00202"></a>00202 <span class="preprocessor">    SHA512_TILDA(x, Ch_temp2),                                 \</span>
<a name="l00203"></a>00203 <span class="preprocessor">    SHA512_AND(Ch_temp2, z, Ch_temp3),                         \</span>
<a name="l00204"></a>00204 <span class="preprocessor">    SHA512_XOR(Ch_temp1, Ch_temp3, (ret)) )</span>
<a name="l00205"></a>00205 <span class="preprocessor"></span>
<a name="l00206"></a>00206 <span class="comment">/*</span>
<a name="l00207"></a>00207 <span class="comment"> *  Maj(x,y,z)  (((x)&amp;(y)) ^ ((x)&amp;(z)) ^ ((y)&amp;(z)))</span>
<a name="l00208"></a>00208 <span class="comment"> */</span>
<a name="l00209"></a>00209 <span class="keyword">static</span> uint32_t Maj_temp1[2], Maj_temp2[2],
<a name="l00210"></a>00210   Maj_temp3[2], Maj_temp4[2];
<a name="l00211"></a>00211 <span class="preprocessor">#define SHA_Maj(x, y, z, ret) (                                \</span>
<a name="l00212"></a>00212 <span class="preprocessor">    SHA512_AND(x, y, Maj_temp1),                               \</span>
<a name="l00213"></a>00213 <span class="preprocessor">    SHA512_AND(x, z, Maj_temp2),                               \</span>
<a name="l00214"></a>00214 <span class="preprocessor">    SHA512_AND(y, z, Maj_temp3),                               \</span>
<a name="l00215"></a>00215 <span class="preprocessor">    SHA512_XOR(Maj_temp2, Maj_temp3, Maj_temp4),               \</span>
<a name="l00216"></a>00216 <span class="preprocessor">    SHA512_XOR(Maj_temp1, Maj_temp4, (ret)) )</span>
<a name="l00217"></a>00217 <span class="preprocessor"></span><span class="preprocessor">#else </span><span class="comment">/* !USE_MODIFIED_MACROS */</span>
<a name="l00218"></a>00218 <span class="comment">/*</span>
<a name="l00219"></a>00219 <span class="comment"> * These definitions are potentially faster equivalents for the ones</span>
<a name="l00220"></a>00220 <span class="comment"> * used in FIPS 180-3, section 4.1.3.</span>
<a name="l00221"></a>00221 <span class="comment"> *   ((x &amp; y) ^ (~x &amp; z)) becomes</span>
<a name="l00222"></a>00222 <span class="comment"> *   ((x &amp; (y ^ z)) ^ z)</span>
<a name="l00223"></a>00223 <span class="comment"> */</span>
<a name="l00224"></a>00224 <span class="preprocessor">#define SHA_Ch(x, y, z, ret) (                                 \</span>
<a name="l00225"></a>00225 <span class="preprocessor">   (ret)[0] = (((x)[0] &amp; ((y)[0] ^ (z)[0])) ^ (z)[0]),         \</span>
<a name="l00226"></a>00226 <span class="preprocessor">   (ret)[1] = (((x)[1] &amp; ((y)[1] ^ (z)[1])) ^ (z)[1]) )</span>
<a name="l00227"></a>00227 <span class="preprocessor"></span>
<a name="l00228"></a>00228 <span class="comment">/*</span>
<a name="l00229"></a>00229 <span class="comment"> *   ((x &amp; y) ^ (x &amp; z) ^ (y &amp; z)) becomes</span>
<a name="l00230"></a>00230 <span class="comment"> *   ((x &amp; (y | z)) | (y &amp; z))</span>
<a name="l00231"></a>00231 <span class="comment"> */</span>
<a name="l00232"></a>00232 <span class="preprocessor">#define SHA_Maj(x, y, z, ret) (                                 \</span>
<a name="l00233"></a>00233 <span class="preprocessor">   ret[0] = (((x)[0] &amp; ((y)[0] | (z)[0])) | ((y)[0] &amp; (z)[0])), \</span>
<a name="l00234"></a>00234 <span class="preprocessor">   ret[1] = (((x)[1] &amp; ((y)[1] | (z)[1])) | ((y)[1] &amp; (z)[1])) )</span>
<a name="l00235"></a>00235 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* USE_MODIFIED_MACROS */</span>
<a name="l00236"></a>00236 
<a name="l00237"></a>00237 <span class="comment">/*</span>
<a name="l00238"></a>00238 <span class="comment"> * Add &quot;length&quot; to the length.</span>
<a name="l00239"></a>00239 <span class="comment"> * Set Corrupted when overflow has occurred.</span>
<a name="l00240"></a>00240 <span class="comment"> */</span>
<a name="l00241"></a>00241 <span class="keyword">static</span> uint32_t <a class="code" href="sha384-512_8c.html#a7f3e654ec05fd30f6d4dff3289967a8b">addTemp</a>[4] = { 0, 0, 0, 0 };
<a name="l00242"></a>00242 <span class="preprocessor">#define SHA384_512AddLength(context, length) (                        \</span>
<a name="l00243"></a>00243 <span class="preprocessor">    addTemp[3] = (length), SHA512_ADDTO4((context)-&gt;Length, addTemp), \</span>
<a name="l00244"></a>00244 <span class="preprocessor">    (context)-&gt;Corrupted = (((context)-&gt;Length[3] &lt; (length)) &amp;&amp;      \</span>
<a name="l00245"></a>00245 <span class="preprocessor">       ((context)-&gt;Length[2] == 0) &amp;&amp; ((context)-&gt;Length[1] == 0) &amp;&amp;  \</span>
<a name="l00246"></a>00246 <span class="preprocessor">       ((context)-&gt;Length[0] == 0)) ? shaInputTooLong :               \</span>
<a name="l00247"></a>00247 <span class="preprocessor">                                      (context)-&gt;Corrupted )</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span>
<a name="l00249"></a>00249 <span class="comment">/* Local Function Prototypes */</span>
<a name="l00250"></a>00250 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="sha384-512_8c.html#af0991cd347edcfc83a25c653e0cc8cd3">SHA384_512Reset</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00251"></a>00251                            uint32_t H0[<a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04a9c2b656e2a8c7b981612de8ddaf2f7be">SHA512HashSize</a>/4]);
<a name="l00252"></a>00252 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="sha384-512_8c.html#a39e7956ca292d5d358d2449b58f0034e">SHA384_512ProcessMessageBlock</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context);
<a name="l00253"></a>00253 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="sha384-512_8c.html#a69a2234ba9c2d56a7f4cfdfcfe138936">SHA384_512Finalize</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00254"></a>00254   uint8_t Pad_Byte);
<a name="l00255"></a>00255 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="sha384-512_8c.html#adb046125a91515d019f7300fce3caf49">SHA384_512PadMessage</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00256"></a>00256   uint8_t Pad_Byte);
<a name="l00257"></a>00257 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="sha384-512_8c.html#af90419c2834cbfcd587b990456f992ab">SHA384_512ResultN</a>( <a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00258"></a>00258   uint8_t Message_Digest[ ], <span class="keywordtype">int</span> HashSize);
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 <span class="comment">/* Initial Hash Values: FIPS 180-3 sections 5.3.4 and 5.3.5 */</span>
<a name="l00261"></a>00261 <span class="keyword">static</span> uint32_t <a class="code" href="sha384-512_8c.html#a4654888c6129f3ec0b92e8d034991792">SHA384_H0</a>[<a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04a9c2b656e2a8c7b981612de8ddaf2f7be">SHA512HashSize</a>/4] = {
<a name="l00262"></a>00262     0xCBBB9D5D, 0xC1059ED8, 0x629A292A, 0x367CD507, 0x9159015A,
<a name="l00263"></a>00263     0x3070DD17, 0x152FECD8, 0xF70E5939, 0x67332667, 0xFFC00B31,
<a name="l00264"></a>00264     0x8EB44A87, 0x68581511, 0xDB0C2E0D, 0x64F98FA7, 0x47B5481D,
<a name="l00265"></a>00265     0xBEFA4FA4
<a name="l00266"></a>00266 };
<a name="l00267"></a>00267 <span class="keyword">static</span> uint32_t <a class="code" href="sha384-512_8c.html#ad7dfb3cc7c458b92b8ce49659dbc85e3">SHA512_H0</a>[<a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04a9c2b656e2a8c7b981612de8ddaf2f7be">SHA512HashSize</a>/4] = {
<a name="l00268"></a>00268     0x6A09E667, 0xF3BCC908, 0xBB67AE85, 0x84CAA73B, 0x3C6EF372,
<a name="l00269"></a>00269     0xFE94F82B, 0xA54FF53A, 0x5F1D36F1, 0x510E527F, 0xADE682D1,
<a name="l00270"></a>00270     0x9B05688C, 0x2B3E6C1F, 0x1F83D9AB, 0xFB41BD6B, 0x5BE0CD19,
<a name="l00271"></a>00271     0x137E2179
<a name="l00272"></a>00272 };
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <span class="preprocessor">#else </span><span class="comment">/* !USE_32BIT_ONLY */</span>
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 <span class="preprocessor">#include &quot;<a class="code" href="sha-private_8h.html">sha-private.h</a>&quot;</span>
<a name="l00277"></a>00277 
<a name="l00278"></a>00278 <span class="comment">/* Define the SHA shift, rotate left and rotate right macros */</span>
<a name="l00279"></a><a class="code" href="sha384-512_8c.html#a6202521b2b7fbabd85e31dc72b983356">00279</a> <span class="preprocessor">#define SHA512_SHR(bits,word)  (((uint64_t)(word)) &gt;&gt; (bits))</span>
<a name="l00280"></a><a class="code" href="sha384-512_8c.html#a6b2264a4e3eb17211df6e3837f797e48">00280</a> <span class="preprocessor"></span><span class="preprocessor">#define SHA512_ROTR(bits,word) ((((uint64_t)(word)) &gt;&gt; (bits)) | \</span>
<a name="l00281"></a>00281 <span class="preprocessor">                                (((uint64_t)(word)) &lt;&lt; (64-(bits))))</span>
<a name="l00282"></a>00282 <span class="preprocessor"></span>
<a name="l00283"></a>00283 <span class="comment">/*</span>
<a name="l00284"></a>00284 <span class="comment"> * Define the SHA SIGMA and sigma macros</span>
<a name="l00285"></a>00285 <span class="comment"> *</span>
<a name="l00286"></a>00286 <span class="comment"> *  SHA512_ROTR(28,word) ^ SHA512_ROTR(34,word) ^ SHA512_ROTR(39,word)</span>
<a name="l00287"></a>00287 <span class="comment"> */</span>
<a name="l00288"></a><a class="code" href="sha384-512_8c.html#a0129685fbd5e05f1fbdefe0b9bb13a94">00288</a> <span class="preprocessor">#define SHA512_SIGMA0(word)   \</span>
<a name="l00289"></a>00289 <span class="preprocessor"> (SHA512_ROTR(28,word) ^ SHA512_ROTR(34,word) ^ SHA512_ROTR(39,word))</span>
<a name="l00290"></a><a class="code" href="sha384-512_8c.html#af5c914090af3e4cdc42f0ee57da07c30">00290</a> <span class="preprocessor"></span><span class="preprocessor">#define SHA512_SIGMA1(word)   \</span>
<a name="l00291"></a>00291 <span class="preprocessor"> (SHA512_ROTR(14,word) ^ SHA512_ROTR(18,word) ^ SHA512_ROTR(41,word))</span>
<a name="l00292"></a><a class="code" href="sha384-512_8c.html#af5df5010907c0366a6f69399302bedb6">00292</a> <span class="preprocessor"></span><span class="preprocessor">#define SHA512_sigma0(word)   \</span>
<a name="l00293"></a>00293 <span class="preprocessor"> (SHA512_ROTR( 1,word) ^ SHA512_ROTR( 8,word) ^ SHA512_SHR( 7,word))</span>
<a name="l00294"></a><a class="code" href="sha384-512_8c.html#a983505d016a3a831401efb655dccb4d1">00294</a> <span class="preprocessor"></span><span class="preprocessor">#define SHA512_sigma1(word)   \</span>
<a name="l00295"></a>00295 <span class="preprocessor"> (SHA512_ROTR(19,word) ^ SHA512_ROTR(61,word) ^ SHA512_SHR( 6,word))</span>
<a name="l00296"></a>00296 <span class="preprocessor"></span>
<a name="l00297"></a>00297 <span class="comment">/*</span>
<a name="l00298"></a>00298 <span class="comment"> * Add &quot;length&quot; to the length.</span>
<a name="l00299"></a>00299 <span class="comment"> * Set Corrupted when overflow has occurred.</span>
<a name="l00300"></a>00300 <span class="comment"> */</span>
<a name="l00301"></a><a class="code" href="sha384-512_8c.html#a7f3e654ec05fd30f6d4dff3289967a8b">00301</a> <span class="keyword">static</span> uint64_t <a class="code" href="sha384-512_8c.html#a7f3e654ec05fd30f6d4dff3289967a8b">addTemp</a>;
<a name="l00302"></a><a class="code" href="sha384-512_8c.html#af0e675d4166c34f2d7df6584218c4770">00302</a> <span class="preprocessor">#define SHA384_512AddLength(context, length)                   \</span>
<a name="l00303"></a>00303 <span class="preprocessor">   (addTemp = context-&gt;Length_Low, context-&gt;Corrupted =        \</span>
<a name="l00304"></a>00304 <span class="preprocessor">    ((context-&gt;Length_Low += length) &lt; addTemp) &amp;&amp;             \</span>
<a name="l00305"></a>00305 <span class="preprocessor">    (++context-&gt;Length_High == 0) ? shaInputTooLong :          \</span>
<a name="l00306"></a>00306 <span class="preprocessor">                                    (context)-&gt;Corrupted)</span>
<a name="l00307"></a>00307 <span class="preprocessor"></span>
<a name="l00308"></a>00308 <span class="comment">/* Local Function Prototypes */</span>
<a name="l00309"></a>00309 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="sha384-512_8c.html#af0991cd347edcfc83a25c653e0cc8cd3">SHA384_512Reset</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00310"></a>00310                            uint64_t H0[<a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04a9c2b656e2a8c7b981612de8ddaf2f7be">SHA512HashSize</a>/8]);
<a name="l00311"></a>00311 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="sha384-512_8c.html#a39e7956ca292d5d358d2449b58f0034e">SHA384_512ProcessMessageBlock</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context);
<a name="l00312"></a>00312 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="sha384-512_8c.html#a69a2234ba9c2d56a7f4cfdfcfe138936">SHA384_512Finalize</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00313"></a>00313   uint8_t Pad_Byte);
<a name="l00314"></a>00314 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="sha384-512_8c.html#adb046125a91515d019f7300fce3caf49">SHA384_512PadMessage</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00315"></a>00315   uint8_t Pad_Byte);
<a name="l00316"></a>00316 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="sha384-512_8c.html#af90419c2834cbfcd587b990456f992ab">SHA384_512ResultN</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00317"></a>00317   uint8_t Message_Digest[ ], <span class="keywordtype">int</span> HashSize);
<a name="l00318"></a>00318 
<a name="l00319"></a>00319 <span class="comment">/* Initial Hash Values: FIPS 180-3 sections 5.3.4 and 5.3.5 */</span>
<a name="l00320"></a><a class="code" href="sha384-512_8c.html#a4654888c6129f3ec0b92e8d034991792">00320</a> <span class="keyword">static</span> uint64_t <a class="code" href="sha384-512_8c.html#a4654888c6129f3ec0b92e8d034991792">SHA384_H0</a>[ ] = {
<a name="l00321"></a>00321     0xCBBB9D5DC1059ED8ll, 0x629A292A367CD507ll, 0x9159015A3070DD17ll,
<a name="l00322"></a>00322     0x152FECD8F70E5939ll, 0x67332667FFC00B31ll, 0x8EB44A8768581511ll,
<a name="l00323"></a>00323     0xDB0C2E0D64F98FA7ll, 0x47B5481DBEFA4FA4ll
<a name="l00324"></a>00324 };
<a name="l00325"></a><a class="code" href="sha384-512_8c.html#ad7dfb3cc7c458b92b8ce49659dbc85e3">00325</a> <span class="keyword">static</span> uint64_t <a class="code" href="sha384-512_8c.html#ad7dfb3cc7c458b92b8ce49659dbc85e3">SHA512_H0</a>[ ] = {
<a name="l00326"></a>00326     0x6A09E667F3BCC908ll, 0xBB67AE8584CAA73Bll, 0x3C6EF372FE94F82Bll,
<a name="l00327"></a>00327     0xA54FF53A5F1D36F1ll, 0x510E527FADE682D1ll, 0x9B05688C2B3E6C1Fll,
<a name="l00328"></a>00328     0x1F83D9ABFB41BD6Bll, 0x5BE0CD19137E2179ll
<a name="l00329"></a>00329 };
<a name="l00330"></a>00330 
<a name="l00331"></a>00331 <span class="preprocessor">#endif </span><span class="comment">/* USE_32BIT_ONLY */</span>
<a name="l00332"></a>00332 
<a name="l00333"></a>00333 <span class="comment">/*</span>
<a name="l00334"></a>00334 <span class="comment"> * SHA384Reset</span>
<a name="l00335"></a>00335 <span class="comment"> *</span>
<a name="l00336"></a>00336 <span class="comment"> * Description:</span>
<a name="l00337"></a>00337 <span class="comment"> *   This function will initialize the SHA384Context in preparation</span>
<a name="l00338"></a>00338 <span class="comment"> *   for computing a new SHA384 message digest.</span>
<a name="l00339"></a>00339 <span class="comment"> *</span>
<a name="l00340"></a>00340 <span class="comment"> * Parameters:</span>
<a name="l00341"></a>00341 <span class="comment"> *   context: [in/out]</span>
<a name="l00342"></a>00342 <span class="comment"> *     The context to reset.</span>
<a name="l00343"></a>00343 <span class="comment"> *</span>
<a name="l00344"></a>00344 <span class="comment"> * Returns:</span>
<a name="l00345"></a>00345 <span class="comment"> *   sha Error Code.</span>
<a name="l00346"></a>00346 <span class="comment"> *</span>
<a name="l00347"></a>00347 <span class="comment"> */</span>
<a name="l00348"></a><a class="code" href="sha384-512_8c.html#a021250cab7a1c3fd5ef7edf83c4e61f6">00348</a> <span class="keywordtype">int</span> <a class="code" href="sha_8h.html#a51b0f913b3bee11c3f40de7246945f5b">SHA384Reset</a>(<a class="code" href="struct_s_h_a512_context.html">SHA384Context</a> *context)
<a name="l00349"></a>00349 {
<a name="l00350"></a>00350   <span class="keywordflow">return</span> <a class="code" href="sha384-512_8c.html#af0991cd347edcfc83a25c653e0cc8cd3">SHA384_512Reset</a>(context, <a class="code" href="sha384-512_8c.html#a4654888c6129f3ec0b92e8d034991792">SHA384_H0</a>);
<a name="l00351"></a>00351 }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 <span class="comment">/*</span>
<a name="l00354"></a>00354 <span class="comment"> * SHA384Input</span>
<a name="l00355"></a>00355 <span class="comment"> *</span>
<a name="l00356"></a>00356 <span class="comment"> * Description:</span>
<a name="l00357"></a>00357 <span class="comment"> *   This function accepts an array of octets as the next portion</span>
<a name="l00358"></a>00358 <span class="comment"> *   of the message.</span>
<a name="l00359"></a>00359 <span class="comment"> *</span>
<a name="l00360"></a>00360 <span class="comment"> * Parameters:</span>
<a name="l00361"></a>00361 <span class="comment"> *   context: [in/out]</span>
<a name="l00362"></a>00362 <span class="comment"> *     The SHA context to update.</span>
<a name="l00363"></a>00363 <span class="comment"> *   message_array[ ]: [in]</span>
<a name="l00364"></a>00364 <span class="comment"> *     An array of octets representing the next portion of</span>
<a name="l00365"></a>00365 <span class="comment"> *     the message.</span>
<a name="l00366"></a>00366 <span class="comment"> *   length: [in]</span>
<a name="l00367"></a>00367 <span class="comment"> *     The length of the message in message_array.</span>
<a name="l00368"></a>00368 <span class="comment"> *</span>
<a name="l00369"></a>00369 <span class="comment"> * Returns:</span>
<a name="l00370"></a>00370 <span class="comment"> *   sha Error Code.</span>
<a name="l00371"></a>00371 <span class="comment"> *</span>
<a name="l00372"></a>00372 <span class="comment"> */</span>
<a name="l00373"></a><a class="code" href="sha384-512_8c.html#ab47748ccc8c42a13e276763539bcb463">00373</a> <span class="keywordtype">int</span> <a class="code" href="sha_8h.html#a93558d6a53241d6ad4eb1b623a966aef">SHA384Input</a>(<a class="code" href="struct_s_h_a512_context.html">SHA384Context</a> *context,
<a name="l00374"></a>00374     <span class="keyword">const</span> uint8_t *message_array, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> length)
<a name="l00375"></a>00375 {
<a name="l00376"></a>00376   <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a6b8f321a1a2a4eb352483549964abfa3">SHA512Input</a>(context, message_array, length);
<a name="l00377"></a>00377 }
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 <span class="comment">/*</span>
<a name="l00380"></a>00380 <span class="comment"> * SHA384FinalBits</span>
<a name="l00381"></a>00381 <span class="comment"> *</span>
<a name="l00382"></a>00382 <span class="comment"> * Description:</span>
<a name="l00383"></a>00383 <span class="comment"> *   This function will add in any final bits of the message.</span>
<a name="l00384"></a>00384 <span class="comment"> *</span>
<a name="l00385"></a>00385 <span class="comment"> * Parameters:</span>
<a name="l00386"></a>00386 <span class="comment"> *   context: [in/out]</span>
<a name="l00387"></a>00387 <span class="comment"> *     The SHA context to update.</span>
<a name="l00388"></a>00388 <span class="comment"> *   message_bits: [in]</span>
<a name="l00389"></a>00389 <span class="comment"> *     The final bits of the message, in the upper portion of the</span>
<a name="l00390"></a>00390 <span class="comment"> *     byte.  (Use 0b###00000 instead of 0b00000### to input the</span>
<a name="l00391"></a>00391 <span class="comment"> *     three bits ###.)</span>
<a name="l00392"></a>00392 <span class="comment"> *   length: [in]</span>
<a name="l00393"></a>00393 <span class="comment"> *     The number of bits in message_bits, between 1 and 7.</span>
<a name="l00394"></a>00394 <span class="comment"> *</span>
<a name="l00395"></a>00395 <span class="comment"> * Returns:</span>
<a name="l00396"></a>00396 <span class="comment"> *   sha Error Code.</span>
<a name="l00397"></a>00397 <span class="comment"> *</span>
<a name="l00398"></a>00398 <span class="comment"> */</span>
<a name="l00399"></a><a class="code" href="sha384-512_8c.html#a49004da979cf883dc7b6d7ee2f50125a">00399</a> <span class="keywordtype">int</span> <a class="code" href="sha_8h.html#aededef989373b2f7f279306325afe0ee">SHA384FinalBits</a>(<a class="code" href="struct_s_h_a512_context.html">SHA384Context</a> *context,
<a name="l00400"></a>00400                     uint8_t message_bits, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> length)
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402   <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a0f04ee4e4886adf418b5938747bc9829">SHA512FinalBits</a>(context, message_bits, length);
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 <span class="comment">/*</span>
<a name="l00406"></a>00406 <span class="comment"> * SHA384Result</span>
<a name="l00407"></a>00407 <span class="comment"> *</span>
<a name="l00408"></a>00408 <span class="comment"> * Description:</span>
<a name="l00409"></a>00409 <span class="comment"> *   This function will return the 384-bit message digest</span>
<a name="l00410"></a>00410 <span class="comment"> *   into the Message_Digest array provided by the caller.</span>
<a name="l00411"></a>00411 <span class="comment"> *   NOTE:</span>
<a name="l00412"></a>00412 <span class="comment"> *    The first octet of hash is stored in the element with index 0,</span>
<a name="l00413"></a>00413 <span class="comment"> *    the last octet of hash in the element with index 47.</span>
<a name="l00414"></a>00414 <span class="comment"> *</span>
<a name="l00415"></a>00415 <span class="comment"> * Parameters:</span>
<a name="l00416"></a>00416 <span class="comment"> *   context: [in/out]</span>
<a name="l00417"></a>00417 <span class="comment"> *     The context to use to calculate the SHA hash.</span>
<a name="l00418"></a>00418 <span class="comment"> *   Message_Digest[ ]: [out]</span>
<a name="l00419"></a>00419 <span class="comment"> *     Where the digest is returned.</span>
<a name="l00420"></a>00420 <span class="comment"> *</span>
<a name="l00421"></a>00421 <span class="comment"> * Returns:</span>
<a name="l00422"></a>00422 <span class="comment"> *   sha Error Code.</span>
<a name="l00423"></a>00423 <span class="comment"> *</span>
<a name="l00424"></a>00424 <span class="comment"> */</span>
<a name="l00425"></a><a class="code" href="sha384-512_8c.html#a3a8b77029c87c149fb73b2eec876199a">00425</a> <span class="keywordtype">int</span> <a class="code" href="sha_8h.html#a0b8e16b3fb60df4b40e43e5a4bcdace4">SHA384Result</a>(<a class="code" href="struct_s_h_a512_context.html">SHA384Context</a> *context,
<a name="l00426"></a>00426     uint8_t Message_Digest[<a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04a1f2e28eb98ef458a8c54e32e9cbe3322">SHA384HashSize</a>])
<a name="l00427"></a>00427 {
<a name="l00428"></a>00428   <span class="keywordflow">return</span> <a class="code" href="sha384-512_8c.html#af90419c2834cbfcd587b990456f992ab">SHA384_512ResultN</a>(context, Message_Digest, SHA384HashSize);
<a name="l00429"></a>00429 }
<a name="l00430"></a>00430 
<a name="l00431"></a>00431 <span class="comment">/*</span>
<a name="l00432"></a>00432 <span class="comment"> * SHA512Reset</span>
<a name="l00433"></a>00433 <span class="comment"> *</span>
<a name="l00434"></a>00434 <span class="comment"> * Description:</span>
<a name="l00435"></a>00435 <span class="comment"> *   This function will initialize the SHA512Context in preparation</span>
<a name="l00436"></a>00436 <span class="comment"> *   for computing a new SHA512 message digest.</span>
<a name="l00437"></a>00437 <span class="comment"> *</span>
<a name="l00438"></a>00438 <span class="comment"> * Parameters:</span>
<a name="l00439"></a>00439 <span class="comment"> *   context: [in/out]</span>
<a name="l00440"></a>00440 <span class="comment"> *     The context to reset.</span>
<a name="l00441"></a>00441 <span class="comment"> *</span>
<a name="l00442"></a>00442 <span class="comment"> * Returns:</span>
<a name="l00443"></a>00443 <span class="comment"> *   sha Error Code.</span>
<a name="l00444"></a>00444 <span class="comment"> *</span>
<a name="l00445"></a>00445 <span class="comment"> */</span>
<a name="l00446"></a><a class="code" href="sha384-512_8c.html#a93a76020a325567d6203cb723764483d">00446</a> <span class="keywordtype">int</span> <a class="code" href="sha_8h.html#a7285c59508e50eb3df136ac3b26c82f7">SHA512Reset</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context)
<a name="l00447"></a>00447 {
<a name="l00448"></a>00448   <span class="keywordflow">return</span> <a class="code" href="sha384-512_8c.html#af0991cd347edcfc83a25c653e0cc8cd3">SHA384_512Reset</a>(context, <a class="code" href="sha384-512_8c.html#ad7dfb3cc7c458b92b8ce49659dbc85e3">SHA512_H0</a>);
<a name="l00449"></a>00449 }
<a name="l00450"></a>00450 
<a name="l00451"></a>00451 <span class="comment">/*</span>
<a name="l00452"></a>00452 <span class="comment"> * SHA512Input</span>
<a name="l00453"></a>00453 <span class="comment"> *</span>
<a name="l00454"></a>00454 <span class="comment"> * Description:</span>
<a name="l00455"></a>00455 <span class="comment"> *   This function accepts an array of octets as the next portion</span>
<a name="l00456"></a>00456 <span class="comment"> *   of the message.</span>
<a name="l00457"></a>00457 <span class="comment"> *</span>
<a name="l00458"></a>00458 <span class="comment"> * Parameters:</span>
<a name="l00459"></a>00459 <span class="comment"> *   context: [in/out]</span>
<a name="l00460"></a>00460 <span class="comment"> *     The SHA context to update.</span>
<a name="l00461"></a>00461 <span class="comment"> *   message_array[ ]: [in]</span>
<a name="l00462"></a>00462 <span class="comment"> *     An array of octets representing the next portion of</span>
<a name="l00463"></a>00463 <span class="comment"> *     the message.</span>
<a name="l00464"></a>00464 <span class="comment"> *   length: [in]</span>
<a name="l00465"></a>00465 <span class="comment"> *     The length of the message in message_array.</span>
<a name="l00466"></a>00466 <span class="comment"> *</span>
<a name="l00467"></a>00467 <span class="comment"> * Returns:</span>
<a name="l00468"></a>00468 <span class="comment"> *   sha Error Code.</span>
<a name="l00469"></a>00469 <span class="comment"> *</span>
<a name="l00470"></a>00470 <span class="comment"> */</span>
<a name="l00471"></a><a class="code" href="sha384-512_8c.html#ac62c7ac6d5984bc7be4ce79589575f40">00471</a> <span class="keywordtype">int</span> <a class="code" href="sha_8h.html#a6b8f321a1a2a4eb352483549964abfa3">SHA512Input</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00472"></a>00472         <span class="keyword">const</span> uint8_t *message_array,
<a name="l00473"></a>00473         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> length)
<a name="l00474"></a>00474 {
<a name="l00475"></a>00475   <span class="keywordflow">if</span> (!context) <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5ae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;
<a name="l00476"></a>00476   <span class="keywordflow">if</span> (!length) <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5a581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;
<a name="l00477"></a>00477   <span class="keywordflow">if</span> (!message_array) <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5ae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;
<a name="l00478"></a>00478   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="struct_s_h_a512_context.html#a8fc7f840bd0ac183cee5dbc05d391918">Computed</a>) <span class="keywordflow">return</span> context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a> = <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5af95bed729cc00460585fb8d76f0c384d">shaStateError</a>;
<a name="l00479"></a>00479   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a>) <span class="keywordflow">return</span> context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a>;
<a name="l00480"></a>00480 
<a name="l00481"></a>00481   <span class="keywordflow">while</span> (length--) {
<a name="l00482"></a>00482     context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[context-&gt;<a class="code" href="struct_s_h_a512_context.html#adb9aaac6288732d941355bfbd45ecd80">Message_Block_Index</a>++] =
<a name="l00483"></a>00483             *message_array;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485     <span class="keywordflow">if</span> ((<a class="code" href="sha384-512_8c.html#af0e675d4166c34f2d7df6584218c4770">SHA384_512AddLength</a>(context, 8) == <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5a581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>) &amp;&amp;
<a name="l00486"></a>00486       (context-&gt;<a class="code" href="struct_s_h_a512_context.html#adb9aaac6288732d941355bfbd45ecd80">Message_Block_Index</a> == <a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04abba971af4f20bede9e0e62472e03e755">SHA512_Message_Block_Size</a>))
<a name="l00487"></a>00487       <a class="code" href="sha384-512_8c.html#a39e7956ca292d5d358d2449b58f0034e">SHA384_512ProcessMessageBlock</a>(context);
<a name="l00488"></a>00488 
<a name="l00489"></a>00489     message_array++;
<a name="l00490"></a>00490   }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   <span class="keywordflow">return</span> context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a>;
<a name="l00493"></a>00493 }
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 <span class="comment">/*</span>
<a name="l00496"></a>00496 <span class="comment"> * SHA512FinalBits</span>
<a name="l00497"></a>00497 <span class="comment"> *</span>
<a name="l00498"></a>00498 <span class="comment"> * Description:</span>
<a name="l00499"></a>00499 <span class="comment"> *   This function will add in any final bits of the message.</span>
<a name="l00500"></a>00500 <span class="comment"> *</span>
<a name="l00501"></a>00501 <span class="comment"> * Parameters:</span>
<a name="l00502"></a>00502 <span class="comment"> *   context: [in/out]</span>
<a name="l00503"></a>00503 <span class="comment"> *     The SHA context to update.</span>
<a name="l00504"></a>00504 <span class="comment"> *   message_bits: [in]</span>
<a name="l00505"></a>00505 <span class="comment"> *     The final bits of the message, in the upper portion of the</span>
<a name="l00506"></a>00506 <span class="comment"> *     byte.  (Use 0b###00000 instead of 0b00000### to input the</span>
<a name="l00507"></a>00507 <span class="comment"> *     three bits ###.)</span>
<a name="l00508"></a>00508 <span class="comment"> *   length: [in]</span>
<a name="l00509"></a>00509 <span class="comment"> *     The number of bits in message_bits, between 1 and 7.</span>
<a name="l00510"></a>00510 <span class="comment"> *</span>
<a name="l00511"></a>00511 <span class="comment"> * Returns:</span>
<a name="l00512"></a>00512 <span class="comment"> *   sha Error Code.</span>
<a name="l00513"></a>00513 <span class="comment"> *</span>
<a name="l00514"></a>00514 <span class="comment"> */</span>
<a name="l00515"></a><a class="code" href="sha384-512_8c.html#af0bb4db9d8f7deaa4953f4117af7ad65">00515</a> <span class="keywordtype">int</span> <a class="code" href="sha_8h.html#a0f04ee4e4886adf418b5938747bc9829">SHA512FinalBits</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00516"></a>00516                     uint8_t message_bits, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> length)
<a name="l00517"></a>00517 {
<a name="l00518"></a>00518   <span class="keyword">static</span> uint8_t masks[8] = {
<a name="l00519"></a>00519       <span class="comment">/* 0 0b00000000 */</span> 0x00, <span class="comment">/* 1 0b10000000 */</span> 0x80,
<a name="l00520"></a>00520       <span class="comment">/* 2 0b11000000 */</span> 0xC0, <span class="comment">/* 3 0b11100000 */</span> 0xE0,
<a name="l00521"></a>00521       <span class="comment">/* 4 0b11110000 */</span> 0xF0, <span class="comment">/* 5 0b11111000 */</span> 0xF8,
<a name="l00522"></a>00522       <span class="comment">/* 6 0b11111100 */</span> 0xFC, <span class="comment">/* 7 0b11111110 */</span> 0xFE
<a name="l00523"></a>00523   };
<a name="l00524"></a>00524   <span class="keyword">static</span> uint8_t markbit[8] = {
<a name="l00525"></a>00525       <span class="comment">/* 0 0b10000000 */</span> 0x80, <span class="comment">/* 1 0b01000000 */</span> 0x40,
<a name="l00526"></a>00526       <span class="comment">/* 2 0b00100000 */</span> 0x20, <span class="comment">/* 3 0b00010000 */</span> 0x10,
<a name="l00527"></a>00527       <span class="comment">/* 4 0b00001000 */</span> 0x08, <span class="comment">/* 5 0b00000100 */</span> 0x04,
<a name="l00528"></a>00528       <span class="comment">/* 6 0b00000010 */</span> 0x02, <span class="comment">/* 7 0b00000001 */</span> 0x01
<a name="l00529"></a>00529   };
<a name="l00530"></a>00530 
<a name="l00531"></a>00531   <span class="keywordflow">if</span> (!context) <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5ae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;
<a name="l00532"></a>00532   <span class="keywordflow">if</span> (!length) <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5a581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;
<a name="l00533"></a>00533   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a>) <span class="keywordflow">return</span> context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a>;
<a name="l00534"></a>00534   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="struct_s_h_a512_context.html#a8fc7f840bd0ac183cee5dbc05d391918">Computed</a>) <span class="keywordflow">return</span> context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a> = <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5af95bed729cc00460585fb8d76f0c384d">shaStateError</a>;
<a name="l00535"></a>00535   <span class="keywordflow">if</span> (length &gt;= 8) <span class="keywordflow">return</span> context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a> = <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5ab338542dac4fd7886c1bcbdfcb58db50">shaBadParam</a>;
<a name="l00536"></a>00536 
<a name="l00537"></a>00537   <a class="code" href="sha384-512_8c.html#af0e675d4166c34f2d7df6584218c4770">SHA384_512AddLength</a>(context, length);
<a name="l00538"></a>00538   <a class="code" href="sha384-512_8c.html#a69a2234ba9c2d56a7f4cfdfcfe138936">SHA384_512Finalize</a>(context, (uint8_t)
<a name="l00539"></a>00539     ((message_bits &amp; masks[length]) | markbit[length]));
<a name="l00540"></a>00540 
<a name="l00541"></a>00541   <span class="keywordflow">return</span> context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a>;
<a name="l00542"></a>00542 }
<a name="l00543"></a>00543 
<a name="l00544"></a>00544 <span class="comment">/*</span>
<a name="l00545"></a>00545 <span class="comment"> * SHA512Result</span>
<a name="l00546"></a>00546 <span class="comment"> *</span>
<a name="l00547"></a>00547 <span class="comment"> * Description:</span>
<a name="l00548"></a>00548 <span class="comment"> *   This function will return the 512-bit message digest</span>
<a name="l00549"></a>00549 <span class="comment"> *   into the Message_Digest array provided by the caller.</span>
<a name="l00550"></a>00550 <span class="comment"> *   NOTE:</span>
<a name="l00551"></a>00551 <span class="comment"> *    The first octet of hash is stored in the element with index 0,</span>
<a name="l00552"></a>00552 <span class="comment"> *    the last octet of hash in the element with index 63.</span>
<a name="l00553"></a>00553 <span class="comment"> *</span>
<a name="l00554"></a>00554 <span class="comment"> * Parameters:</span>
<a name="l00555"></a>00555 <span class="comment"> *   context: [in/out]</span>
<a name="l00556"></a>00556 <span class="comment"> *     The context to use to calculate the SHA hash.</span>
<a name="l00557"></a>00557 <span class="comment"> *   Message_Digest[ ]: [out]</span>
<a name="l00558"></a>00558 <span class="comment"> *     Where the digest is returned.</span>
<a name="l00559"></a>00559 <span class="comment"> *</span>
<a name="l00560"></a>00560 <span class="comment"> * Returns:</span>
<a name="l00561"></a>00561 <span class="comment"> *   sha Error Code.</span>
<a name="l00562"></a>00562 <span class="comment"> *</span>
<a name="l00563"></a>00563 <span class="comment"> */</span>
<a name="l00564"></a><a class="code" href="sha384-512_8c.html#a3a363b7b0452df8899828908d11ee97e">00564</a> <span class="keywordtype">int</span> <a class="code" href="sha_8h.html#a0303478bf3bc61891dc20555f9e10e22">SHA512Result</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00565"></a>00565     uint8_t Message_Digest[<a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04a9c2b656e2a8c7b981612de8ddaf2f7be">SHA512HashSize</a>])
<a name="l00566"></a>00566 {
<a name="l00567"></a>00567   <span class="keywordflow">return</span> <a class="code" href="sha384-512_8c.html#af90419c2834cbfcd587b990456f992ab">SHA384_512ResultN</a>(context, Message_Digest, SHA512HashSize);
<a name="l00568"></a>00568 }
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 <span class="comment">/*</span>
<a name="l00571"></a>00571 <span class="comment"> * SHA384_512Reset</span>
<a name="l00572"></a>00572 <span class="comment"> *</span>
<a name="l00573"></a>00573 <span class="comment"> * Description:</span>
<a name="l00574"></a>00574 <span class="comment"> *   This helper function will initialize the SHA512Context in</span>
<a name="l00575"></a>00575 <span class="comment"> *   preparation for computing a new SHA384 or SHA512 message</span>
<a name="l00576"></a>00576 <span class="comment"> *   digest.</span>
<a name="l00577"></a>00577 <span class="comment"> *</span>
<a name="l00578"></a>00578 <span class="comment"> * Parameters:</span>
<a name="l00579"></a>00579 <span class="comment"> *   context: [in/out]</span>
<a name="l00580"></a>00580 <span class="comment"> *     The context to reset.</span>
<a name="l00581"></a>00581 <span class="comment"> *   H0[ ]: [in]</span>
<a name="l00582"></a>00582 <span class="comment"> *     The initial hash value array to use.</span>
<a name="l00583"></a>00583 <span class="comment"> *</span>
<a name="l00584"></a>00584 <span class="comment"> * Returns:</span>
<a name="l00585"></a>00585 <span class="comment"> *   sha Error Code.</span>
<a name="l00586"></a>00586 <span class="comment"> *</span>
<a name="l00587"></a>00587 <span class="comment"> */</span>
<a name="l00588"></a>00588 <span class="preprocessor">#ifdef USE_32BIT_ONLY</span>
<a name="l00589"></a>00589 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="sha384-512_8c.html#af0991cd347edcfc83a25c653e0cc8cd3">SHA384_512Reset</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00590"></a>00590                            uint32_t H0[<a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04a9c2b656e2a8c7b981612de8ddaf2f7be">SHA512HashSize</a>/4])
<a name="l00591"></a>00591 <span class="preprocessor">#else </span><span class="comment">/* !USE_32BIT_ONLY */</span>
<a name="l00592"></a><a class="code" href="sha384-512_8c.html#af0991cd347edcfc83a25c653e0cc8cd3">00592</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="sha384-512_8c.html#af0991cd347edcfc83a25c653e0cc8cd3">SHA384_512Reset</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00593"></a>00593                            uint64_t H0[<a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04a9c2b656e2a8c7b981612de8ddaf2f7be">SHA512HashSize</a>/8])
<a name="l00594"></a>00594 <span class="preprocessor">#endif </span><span class="comment">/* USE_32BIT_ONLY */</span>
<a name="l00595"></a>00595 {
<a name="l00596"></a>00596   <span class="keywordtype">int</span> i;
<a name="l00597"></a>00597   <span class="keywordflow">if</span> (!context) <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5ae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;
<a name="l00598"></a>00598   context-&gt;<a class="code" href="struct_s_h_a512_context.html#adb9aaac6288732d941355bfbd45ecd80">Message_Block_Index</a> = 0;
<a name="l00599"></a>00599 
<a name="l00600"></a>00600 <span class="preprocessor">#ifdef USE_32BIT_ONLY</span>
<a name="l00601"></a>00601 <span class="preprocessor"></span>  context-&gt;Length[0] = context-&gt;Length[1] =
<a name="l00602"></a>00602   context-&gt;Length[2] = context-&gt;Length[3] = 0;
<a name="l00603"></a>00603 
<a name="l00604"></a>00604   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04a9c2b656e2a8c7b981612de8ddaf2f7be">SHA512HashSize</a>/4; i++)
<a name="l00605"></a>00605     context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[i] = H0[i];
<a name="l00606"></a>00606 #<span class="keywordflow">else</span> <span class="comment">/* !USE_32BIT_ONLY */</span>
<a name="l00607"></a>00607   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a99e986229bd70b2d70118ee67d9e0f3d">Length_High</a> = context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab016a7edf3519fd9ae51c6c5979e8495">Length_Low</a> = 0;
<a name="l00608"></a>00608 
<a name="l00609"></a>00609   for (i = 0; i &lt; <a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04a9c2b656e2a8c7b981612de8ddaf2f7be">SHA512HashSize</a>/8; i++)
<a name="l00610"></a>00610     context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[i] = H0[i];
<a name="l00611"></a>00611 #endif <span class="comment">/* USE_32BIT_ONLY */</span>
<a name="l00612"></a>00612 
<a name="l00613"></a>00613   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a8fc7f840bd0ac183cee5dbc05d391918">Computed</a> = 0;
<a name="l00614"></a>00614   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a> = <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5a581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;
<a name="l00615"></a>00615 
<a name="l00616"></a>00616   <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5a581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;
<a name="l00617"></a>00617 }
<a name="l00618"></a>00618 
<a name="l00619"></a>00619 <span class="comment">/*</span>
<a name="l00620"></a>00620 <span class="comment"> * SHA384_512ProcessMessageBlock</span>
<a name="l00621"></a>00621 <span class="comment"> *</span>
<a name="l00622"></a>00622 <span class="comment"> * Description:</span>
<a name="l00623"></a>00623 <span class="comment"> *   This helper function will process the next 1024 bits of the</span>
<a name="l00624"></a>00624 <span class="comment"> *   message stored in the Message_Block array.</span>
<a name="l00625"></a>00625 <span class="comment"> *</span>
<a name="l00626"></a>00626 <span class="comment"> * Parameters:</span>
<a name="l00627"></a>00627 <span class="comment"> *   context: [in/out]</span>
<a name="l00628"></a>00628 <span class="comment"> *     The SHA context to update.</span>
<a name="l00629"></a>00629 <span class="comment"> *</span>
<a name="l00630"></a>00630 <span class="comment"> * Returns:</span>
<a name="l00631"></a>00631 <span class="comment"> *   Nothing.</span>
<a name="l00632"></a>00632 <span class="comment"> *</span>
<a name="l00633"></a>00633 <span class="comment"> * Comments:</span>
<a name="l00634"></a>00634 <span class="comment"> *   Many of the variable names in this code, especially the</span>
<a name="l00635"></a>00635 <span class="comment"> *   single character names, were used because those were the</span>
<a name="l00636"></a>00636 <span class="comment"> *   names used in the Secure Hash Standard.</span>
<a name="l00637"></a>00637 <span class="comment"> *</span>
<a name="l00638"></a>00638 <span class="comment"> *</span>
<a name="l00639"></a>00639 <span class="comment"> */</span>
<a name="l00640"></a><a class="code" href="sha384-512_8c.html#a39e7956ca292d5d358d2449b58f0034e">00640</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="sha384-512_8c.html#a39e7956ca292d5d358d2449b58f0034e">SHA384_512ProcessMessageBlock</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context)
<a name="l00641"></a>00641 {
<a name="l00642"></a>00642 <span class="preprocessor">#ifdef USE_32BIT_ONLY</span>
<a name="l00643"></a>00643 <span class="preprocessor"></span>  <span class="comment">/* Constants defined in FIPS 180-3, section 4.2.3 */</span>
<a name="l00644"></a>00644   <span class="keyword">static</span> <span class="keyword">const</span> uint32_t K[80*2] = {
<a name="l00645"></a>00645       0x428A2F98, 0xD728AE22, 0x71374491, 0x23EF65CD, 0xB5C0FBCF,
<a name="l00646"></a>00646       0xEC4D3B2F, 0xE9B5DBA5, 0x8189DBBC, 0x3956C25B, 0xF348B538,
<a name="l00647"></a>00647       0x59F111F1, 0xB605D019, 0x923F82A4, 0xAF194F9B, 0xAB1C5ED5,
<a name="l00648"></a>00648       0xDA6D8118, 0xD807AA98, 0xA3030242, 0x12835B01, 0x45706FBE,
<a name="l00649"></a>00649       0x243185BE, 0x4EE4B28C, 0x550C7DC3, 0xD5FFB4E2, 0x72BE5D74,
<a name="l00650"></a>00650       0xF27B896F, 0x80DEB1FE, 0x3B1696B1, 0x9BDC06A7, 0x25C71235,
<a name="l00651"></a>00651       0xC19BF174, 0xCF692694, 0xE49B69C1, 0x9EF14AD2, 0xEFBE4786,
<a name="l00652"></a>00652       0x384F25E3, 0x0FC19DC6, 0x8B8CD5B5, 0x240CA1CC, 0x77AC9C65,
<a name="l00653"></a>00653       0x2DE92C6F, 0x592B0275, 0x4A7484AA, 0x6EA6E483, 0x5CB0A9DC,
<a name="l00654"></a>00654       0xBD41FBD4, 0x76F988DA, 0x831153B5, 0x983E5152, 0xEE66DFAB,
<a name="l00655"></a>00655       0xA831C66D, 0x2DB43210, 0xB00327C8, 0x98FB213F, 0xBF597FC7,
<a name="l00656"></a>00656       0xBEEF0EE4, 0xC6E00BF3, 0x3DA88FC2, 0xD5A79147, 0x930AA725,
<a name="l00657"></a>00657       0x06CA6351, 0xE003826F, 0x14292967, 0x0A0E6E70, 0x27B70A85,
<a name="l00658"></a>00658       0x46D22FFC, 0x2E1B2138, 0x5C26C926, 0x4D2C6DFC, 0x5AC42AED,
<a name="l00659"></a>00659       0x53380D13, 0x9D95B3DF, 0x650A7354, 0x8BAF63DE, 0x766A0ABB,
<a name="l00660"></a>00660       0x3C77B2A8, 0x81C2C92E, 0x47EDAEE6, 0x92722C85, 0x1482353B,
<a name="l00661"></a>00661       0xA2BFE8A1, 0x4CF10364, 0xA81A664B, 0xBC423001, 0xC24B8B70,
<a name="l00662"></a>00662       0xD0F89791, 0xC76C51A3, 0x0654BE30, 0xD192E819, 0xD6EF5218,
<a name="l00663"></a>00663       0xD6990624, 0x5565A910, 0xF40E3585, 0x5771202A, 0x106AA070,
<a name="l00664"></a>00664       0x32BBD1B8, 0x19A4C116, 0xB8D2D0C8, 0x1E376C08, 0x5141AB53,
<a name="l00665"></a>00665       0x2748774C, 0xDF8EEB99, 0x34B0BCB5, 0xE19B48A8, 0x391C0CB3,
<a name="l00666"></a>00666       0xC5C95A63, 0x4ED8AA4A, 0xE3418ACB, 0x5B9CCA4F, 0x7763E373,
<a name="l00667"></a>00667       0x682E6FF3, 0xD6B2B8A3, 0x748F82EE, 0x5DEFB2FC, 0x78A5636F,
<a name="l00668"></a>00668       0x43172F60, 0x84C87814, 0xA1F0AB72, 0x8CC70208, 0x1A6439EC,
<a name="l00669"></a>00669       0x90BEFFFA, 0x23631E28, 0xA4506CEB, 0xDE82BDE9, 0xBEF9A3F7,
<a name="l00670"></a>00670       0xB2C67915, 0xC67178F2, 0xE372532B, 0xCA273ECE, 0xEA26619C,
<a name="l00671"></a>00671       0xD186B8C7, 0x21C0C207, 0xEADA7DD6, 0xCDE0EB1E, 0xF57D4F7F,
<a name="l00672"></a>00672       0xEE6ED178, 0x06F067AA, 0x72176FBA, 0x0A637DC5, 0xA2C898A6,
<a name="l00673"></a>00673       0x113F9804, 0xBEF90DAE, 0x1B710B35, 0x131C471B, 0x28DB77F5,
<a name="l00674"></a>00674       0x23047D84, 0x32CAAB7B, 0x40C72493, 0x3C9EBE0A, 0x15C9BEBC,
<a name="l00675"></a>00675       0x431D67C4, 0x9C100D4C, 0x4CC5D4BE, 0xCB3E42B6, 0x597F299C,
<a name="l00676"></a>00676       0xFC657E2A, 0x5FCB6FAB, 0x3AD6FAEC, 0x6C44198C, 0x4A475817
<a name="l00677"></a>00677   };
<a name="l00678"></a>00678   <span class="keywordtype">int</span>     t, t2, t8;                  <span class="comment">/* Loop counter */</span>
<a name="l00679"></a>00679   uint32_t  temp1[2], temp2[2],       <span class="comment">/* Temporary word values */</span>
<a name="l00680"></a>00680         temp3[2], temp4[2], temp5[2];
<a name="l00681"></a>00681   uint32_t  W[2*80];                  <span class="comment">/* Word sequence */</span>
<a name="l00682"></a>00682   uint32_t  A[2], B[2], C[2], D[2],   <span class="comment">/* Word buffers */</span>
<a name="l00683"></a>00683         E[2], F[2], G[2], H[2];
<a name="l00684"></a>00684 
<a name="l00685"></a>00685   <span class="comment">/* Initialize the first 16 words in the array W */</span>
<a name="l00686"></a>00686   <span class="keywordflow">for</span> (t = t2 = t8 = 0; t &lt; 16; t++, t8 += 8) {
<a name="l00687"></a>00687     W[t2++] = ((((uint32_t)context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8    ])) &lt;&lt; 24) |
<a name="l00688"></a>00688               ((((uint32_t)context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 1])) &lt;&lt; 16) |
<a name="l00689"></a>00689               ((((uint32_t)context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 2])) &lt;&lt; 8) |
<a name="l00690"></a>00690               ((((uint32_t)context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 3])));
<a name="l00691"></a>00691     W[t2++] = ((((uint32_t)context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 4])) &lt;&lt; 24) |
<a name="l00692"></a>00692               ((((uint32_t)context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 5])) &lt;&lt; 16) |
<a name="l00693"></a>00693               ((((uint32_t)context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 6])) &lt;&lt; 8) |
<a name="l00694"></a>00694               ((((uint32_t)context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 7])));
<a name="l00695"></a>00695   }
<a name="l00696"></a>00696 
<a name="l00697"></a>00697   <span class="keywordflow">for</span> (t = 16; t &lt; 80; t++, t2 += 2) {
<a name="l00698"></a>00698     <span class="comment">/* W[t] = SHA512_sigma1(W[t-2]) + W[t-7] +</span>
<a name="l00699"></a>00699 <span class="comment">      SHA512_sigma0(W[t-15]) + W[t-16]; */</span>
<a name="l00700"></a>00700     uint32_t *Wt2 = &amp;W[t2-2*2];
<a name="l00701"></a>00701     uint32_t *Wt7 = &amp;W[t2-7*2];
<a name="l00702"></a>00702     uint32_t *Wt15 = &amp;W[t2-15*2];
<a name="l00703"></a>00703     uint32_t *Wt16 = &amp;W[t2-16*2];
<a name="l00704"></a>00704     <a class="code" href="sha384-512_8c.html#a983505d016a3a831401efb655dccb4d1">SHA512_sigma1</a>(Wt2, temp1);
<a name="l00705"></a>00705     SHA512_ADD(temp1, Wt7, temp2);
<a name="l00706"></a>00706     <a class="code" href="sha384-512_8c.html#af5df5010907c0366a6f69399302bedb6">SHA512_sigma0</a>(Wt15, temp1);
<a name="l00707"></a>00707     SHA512_ADD(temp1, Wt16, temp3);
<a name="l00708"></a>00708     SHA512_ADD(temp2, temp3, &amp;W[t2]);
<a name="l00709"></a>00709   }
<a name="l00710"></a>00710 
<a name="l00711"></a>00711   A[0] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[0];
<a name="l00712"></a>00712   A[1] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[1];
<a name="l00713"></a>00713   B[0] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[2];
<a name="l00714"></a>00714   B[1] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[3];
<a name="l00715"></a>00715   C[0] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[4];
<a name="l00716"></a>00716   C[1] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[5];
<a name="l00717"></a>00717   D[0] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[6];
<a name="l00718"></a>00718   D[1] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[7];
<a name="l00719"></a>00719   E[0] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[8];
<a name="l00720"></a>00720   E[1] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[9];
<a name="l00721"></a>00721   F[0] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[10];
<a name="l00722"></a>00722   F[1] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[11];
<a name="l00723"></a>00723   G[0] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[12];
<a name="l00724"></a>00724   G[1] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[13];
<a name="l00725"></a>00725   H[0] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[14];
<a name="l00726"></a>00726   H[1] = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[15];
<a name="l00727"></a>00727 
<a name="l00728"></a>00728   <span class="keywordflow">for</span> (t = t2 = 0; t &lt; 80; t++, t2 += 2) {
<a name="l00729"></a>00729     <span class="comment">/*</span>
<a name="l00730"></a>00730 <span class="comment">     * temp1 = H + SHA512_SIGMA1(E) + SHA_Ch(E,F,G) + K[t] + W[t];</span>
<a name="l00731"></a>00731 <span class="comment">     */</span>
<a name="l00732"></a>00732     <a class="code" href="sha384-512_8c.html#af5c914090af3e4cdc42f0ee57da07c30">SHA512_SIGMA1</a>(E,temp1);
<a name="l00733"></a>00733     SHA512_ADD(H, temp1, temp2);
<a name="l00734"></a>00734     <a class="code" href="sha-private_8h.html#a6aad1464e4cf4e57f0e2551558f0d783">SHA_Ch</a>(E,F,G,temp3);
<a name="l00735"></a>00735     SHA512_ADD(temp2, temp3, temp4);
<a name="l00736"></a>00736     SHA512_ADD(&amp;K[t2], &amp;W[t2], temp5);
<a name="l00737"></a>00737     SHA512_ADD(temp4, temp5, temp1);
<a name="l00738"></a>00738     <span class="comment">/*</span>
<a name="l00739"></a>00739 <span class="comment">     * temp2 = SHA512_SIGMA0(A) + SHA_Maj(A,B,C);</span>
<a name="l00740"></a>00740 <span class="comment">     */</span>
<a name="l00741"></a>00741     <a class="code" href="sha384-512_8c.html#a0129685fbd5e05f1fbdefe0b9bb13a94">SHA512_SIGMA0</a>(A,temp3);
<a name="l00742"></a>00742     <a class="code" href="sha-private_8h.html#a34c488411532e284913ae6c4ac5c1e75">SHA_Maj</a>(A,B,C,temp4);
<a name="l00743"></a>00743     SHA512_ADD(temp3, temp4, temp2);
<a name="l00744"></a>00744     H[0] = G[0]; H[1] = G[1];
<a name="l00745"></a>00745     G[0] = F[0]; G[1] = F[1];
<a name="l00746"></a>00746     F[0] = E[0]; F[1] = E[1];
<a name="l00747"></a>00747     SHA512_ADD(D, temp1, E);
<a name="l00748"></a>00748     D[0] = C[0]; D[1] = C[1];
<a name="l00749"></a>00749     C[0] = B[0]; C[1] = B[1];
<a name="l00750"></a>00750     B[0] = A[0]; B[1] = A[1];
<a name="l00751"></a>00751     SHA512_ADD(temp1, temp2, A);
<a name="l00752"></a>00752   }
<a name="l00753"></a>00753 
<a name="l00754"></a>00754   SHA512_ADDTO2(&amp;context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[0], A);
<a name="l00755"></a>00755   SHA512_ADDTO2(&amp;context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[2], B);
<a name="l00756"></a>00756   SHA512_ADDTO2(&amp;context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[4], C);
<a name="l00757"></a>00757   SHA512_ADDTO2(&amp;context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[6], D);
<a name="l00758"></a>00758   SHA512_ADDTO2(&amp;context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[8], E);
<a name="l00759"></a>00759   SHA512_ADDTO2(&amp;context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[10], F);
<a name="l00760"></a>00760   SHA512_ADDTO2(&amp;context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[12], G);
<a name="l00761"></a>00761   SHA512_ADDTO2(&amp;context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[14], H);
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 <span class="preprocessor">#else </span><span class="comment">/* !USE_32BIT_ONLY */</span>
<a name="l00764"></a>00764   <span class="comment">/* Constants defined in FIPS 180-3, section 4.2.3 */</span>
<a name="l00765"></a>00765   <span class="keyword">static</span> <span class="keyword">const</span> uint64_t K[80] = {
<a name="l00766"></a>00766       0x428A2F98D728AE22ll, 0x7137449123EF65CDll, 0xB5C0FBCFEC4D3B2Fll,
<a name="l00767"></a>00767       0xE9B5DBA58189DBBCll, 0x3956C25BF348B538ll, 0x59F111F1B605D019ll,
<a name="l00768"></a>00768       0x923F82A4AF194F9Bll, 0xAB1C5ED5DA6D8118ll, 0xD807AA98A3030242ll,
<a name="l00769"></a>00769       0x12835B0145706FBEll, 0x243185BE4EE4B28Cll, 0x550C7DC3D5FFB4E2ll,
<a name="l00770"></a>00770       0x72BE5D74F27B896Fll, 0x80DEB1FE3B1696B1ll, 0x9BDC06A725C71235ll,
<a name="l00771"></a>00771       0xC19BF174CF692694ll, 0xE49B69C19EF14AD2ll, 0xEFBE4786384F25E3ll,
<a name="l00772"></a>00772       0x0FC19DC68B8CD5B5ll, 0x240CA1CC77AC9C65ll, 0x2DE92C6F592B0275ll,
<a name="l00773"></a>00773       0x4A7484AA6EA6E483ll, 0x5CB0A9DCBD41FBD4ll, 0x76F988DA831153B5ll,
<a name="l00774"></a>00774       0x983E5152EE66DFABll, 0xA831C66D2DB43210ll, 0xB00327C898FB213Fll,
<a name="l00775"></a>00775       0xBF597FC7BEEF0EE4ll, 0xC6E00BF33DA88FC2ll, 0xD5A79147930AA725ll,
<a name="l00776"></a>00776       0x06CA6351E003826Fll, 0x142929670A0E6E70ll, 0x27B70A8546D22FFCll,
<a name="l00777"></a>00777       0x2E1B21385C26C926ll, 0x4D2C6DFC5AC42AEDll, 0x53380D139D95B3DFll,
<a name="l00778"></a>00778       0x650A73548BAF63DEll, 0x766A0ABB3C77B2A8ll, 0x81C2C92E47EDAEE6ll,
<a name="l00779"></a>00779       0x92722C851482353Bll, 0xA2BFE8A14CF10364ll, 0xA81A664BBC423001ll,
<a name="l00780"></a>00780       0xC24B8B70D0F89791ll, 0xC76C51A30654BE30ll, 0xD192E819D6EF5218ll,
<a name="l00781"></a>00781       0xD69906245565A910ll, 0xF40E35855771202All, 0x106AA07032BBD1B8ll,
<a name="l00782"></a>00782       0x19A4C116B8D2D0C8ll, 0x1E376C085141AB53ll, 0x2748774CDF8EEB99ll,
<a name="l00783"></a>00783       0x34B0BCB5E19B48A8ll, 0x391C0CB3C5C95A63ll, 0x4ED8AA4AE3418ACBll,
<a name="l00784"></a>00784       0x5B9CCA4F7763E373ll, 0x682E6FF3D6B2B8A3ll, 0x748F82EE5DEFB2FCll,
<a name="l00785"></a>00785       0x78A5636F43172F60ll, 0x84C87814A1F0AB72ll, 0x8CC702081A6439ECll,
<a name="l00786"></a>00786       0x90BEFFFA23631E28ll, 0xA4506CEBDE82BDE9ll, 0xBEF9A3F7B2C67915ll,
<a name="l00787"></a>00787       0xC67178F2E372532Bll, 0xCA273ECEEA26619Cll, 0xD186B8C721C0C207ll,
<a name="l00788"></a>00788       0xEADA7DD6CDE0EB1Ell, 0xF57D4F7FEE6ED178ll, 0x06F067AA72176FBAll,
<a name="l00789"></a>00789       0x0A637DC5A2C898A6ll, 0x113F9804BEF90DAEll, 0x1B710B35131C471Bll,
<a name="l00790"></a>00790       0x28DB77F523047D84ll, 0x32CAAB7B40C72493ll, 0x3C9EBE0A15C9BEBCll,
<a name="l00791"></a>00791       0x431D67C49C100D4Cll, 0x4CC5D4BECB3E42B6ll, 0x597F299CFC657E2All,
<a name="l00792"></a>00792       0x5FCB6FAB3AD6FAECll, 0x6C44198C4A475817ll
<a name="l00793"></a>00793   };
<a name="l00794"></a>00794   <span class="keywordtype">int</span>        t, t8;                   <span class="comment">/* Loop counter */</span>
<a name="l00795"></a>00795   uint64_t   temp1, temp2;            <span class="comment">/* Temporary word value */</span>
<a name="l00796"></a>00796   uint64_t   W[80];                   <span class="comment">/* Word sequence */</span>
<a name="l00797"></a>00797   uint64_t   A, B, C, D, E, F, G, H;  <span class="comment">/* Word buffers */</span>
<a name="l00798"></a>00798 
<a name="l00799"></a>00799   <span class="comment">/*</span>
<a name="l00800"></a>00800 <span class="comment">   * Initialize the first 16 words in the array W</span>
<a name="l00801"></a>00801 <span class="comment">   */</span>
<a name="l00802"></a>00802   <span class="keywordflow">for</span> (t = t8 = 0; t &lt; 16; t++, t8 += 8)
<a name="l00803"></a>00803     W[t] = ((uint64_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8  ]) &lt;&lt; 56) |
<a name="l00804"></a>00804            ((uint64_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 1]) &lt;&lt; 48) |
<a name="l00805"></a>00805            ((uint64_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 2]) &lt;&lt; 40) |
<a name="l00806"></a>00806            ((uint64_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 3]) &lt;&lt; 32) |
<a name="l00807"></a>00807            ((uint64_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 4]) &lt;&lt; 24) |
<a name="l00808"></a>00808            ((uint64_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 5]) &lt;&lt; 16) |
<a name="l00809"></a>00809            ((uint64_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 6]) &lt;&lt; 8) |
<a name="l00810"></a>00810            ((uint64_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[t8 + 7]));
<a name="l00811"></a>00811 
<a name="l00812"></a>00812   <span class="keywordflow">for</span> (t = 16; t &lt; 80; t++)
<a name="l00813"></a>00813     W[t] = <a class="code" href="sha384-512_8c.html#a983505d016a3a831401efb655dccb4d1">SHA512_sigma1</a>(W[t-2]) + W[t-7] +
<a name="l00814"></a>00814         <a class="code" href="sha384-512_8c.html#af5df5010907c0366a6f69399302bedb6">SHA512_sigma0</a>(W[t-15]) + W[t-16];
<a name="l00815"></a>00815   A = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[0];
<a name="l00816"></a>00816   B = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[1];
<a name="l00817"></a>00817   C = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[2];
<a name="l00818"></a>00818   D = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[3];
<a name="l00819"></a>00819   E = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[4];
<a name="l00820"></a>00820   F = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[5];
<a name="l00821"></a>00821   G = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[6];
<a name="l00822"></a>00822   H = context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[7];
<a name="l00823"></a>00823 
<a name="l00824"></a>00824   <span class="keywordflow">for</span> (t = 0; t &lt; 80; t++) {
<a name="l00825"></a>00825     temp1 = H + <a class="code" href="sha384-512_8c.html#af5c914090af3e4cdc42f0ee57da07c30">SHA512_SIGMA1</a>(E) + <a class="code" href="sha-private_8h.html#a6aad1464e4cf4e57f0e2551558f0d783">SHA_Ch</a>(E,F,G) + K[t] + W[t];
<a name="l00826"></a>00826     temp2 = <a class="code" href="sha384-512_8c.html#a0129685fbd5e05f1fbdefe0b9bb13a94">SHA512_SIGMA0</a>(A) + <a class="code" href="sha-private_8h.html#a34c488411532e284913ae6c4ac5c1e75">SHA_Maj</a>(A,B,C);
<a name="l00827"></a>00827     H = G;
<a name="l00828"></a>00828     G = F;
<a name="l00829"></a>00829     F = E;
<a name="l00830"></a>00830     E = D + temp1;
<a name="l00831"></a>00831     D = C;
<a name="l00832"></a>00832     C = B;
<a name="l00833"></a>00833     B = A;
<a name="l00834"></a>00834     A = temp1 + temp2;
<a name="l00835"></a>00835   }
<a name="l00836"></a>00836 
<a name="l00837"></a>00837   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[0] += A;
<a name="l00838"></a>00838   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[1] += B;
<a name="l00839"></a>00839   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[2] += C;
<a name="l00840"></a>00840   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[3] += D;
<a name="l00841"></a>00841   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[4] += E;
<a name="l00842"></a>00842   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[5] += F;
<a name="l00843"></a>00843   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[6] += G;
<a name="l00844"></a>00844   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[7] += H;
<a name="l00845"></a>00845 <span class="preprocessor">#endif </span><span class="comment">/* USE_32BIT_ONLY */</span>
<a name="l00846"></a>00846 
<a name="l00847"></a>00847   context-&gt;<a class="code" href="struct_s_h_a512_context.html#adb9aaac6288732d941355bfbd45ecd80">Message_Block_Index</a> = 0;
<a name="l00848"></a>00848 }
<a name="l00849"></a>00849 
<a name="l00850"></a>00850 <span class="comment">/*</span>
<a name="l00851"></a>00851 <span class="comment"> * SHA384_512Finalize</span>
<a name="l00852"></a>00852 <span class="comment"> *</span>
<a name="l00853"></a>00853 <span class="comment"> * Description:</span>
<a name="l00854"></a>00854 <span class="comment"> *   This helper function finishes off the digest calculations.</span>
<a name="l00855"></a>00855 <span class="comment"> *</span>
<a name="l00856"></a>00856 <span class="comment"> * Parameters:</span>
<a name="l00857"></a>00857 <span class="comment"> *   context: [in/out]</span>
<a name="l00858"></a>00858 <span class="comment"> *     The SHA context to update.</span>
<a name="l00859"></a>00859 <span class="comment"> *   Pad_Byte: [in]</span>
<a name="l00860"></a>00860 <span class="comment"> *     The last byte to add to the message block before the 0-padding</span>
<a name="l00861"></a>00861 <span class="comment"> *     and length.  This will contain the last bits of the message</span>
<a name="l00862"></a>00862 <span class="comment"> *     followed by another single bit.  If the message was an</span>
<a name="l00863"></a>00863 <span class="comment"> *     exact multiple of 8-bits long, Pad_Byte will be 0x80.</span>
<a name="l00864"></a>00864 <span class="comment"> *</span>
<a name="l00865"></a>00865 <span class="comment"> * Returns:</span>
<a name="l00866"></a>00866 <span class="comment"> *   sha Error Code.</span>
<a name="l00867"></a>00867 <span class="comment"> *</span>
<a name="l00868"></a>00868 <span class="comment"> */</span>
<a name="l00869"></a><a class="code" href="sha384-512_8c.html#a69a2234ba9c2d56a7f4cfdfcfe138936">00869</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="sha384-512_8c.html#a69a2234ba9c2d56a7f4cfdfcfe138936">SHA384_512Finalize</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00870"></a>00870     uint8_t Pad_Byte)
<a name="l00871"></a>00871 {
<a name="l00872"></a>00872   int_least16_t i;
<a name="l00873"></a>00873   <a class="code" href="sha384-512_8c.html#adb046125a91515d019f7300fce3caf49">SHA384_512PadMessage</a>(context, Pad_Byte);
<a name="l00874"></a>00874   <span class="comment">/* message may be sensitive, clear it out */</span>
<a name="l00875"></a>00875   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04abba971af4f20bede9e0e62472e03e755">SHA512_Message_Block_Size</a>; ++i)
<a name="l00876"></a>00876     context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[i] = 0;
<a name="l00877"></a>00877 #ifdef USE_32BIT_ONLY    <span class="comment">/* and clear length */</span>
<a name="l00878"></a>00878   context-&gt;Length[0] = context-&gt;Length[1] = 0;
<a name="l00879"></a>00879   context-&gt;Length[2] = context-&gt;Length[3] = 0;
<a name="l00880"></a>00880 #<span class="keywordflow">else</span> <span class="comment">/* !USE_32BIT_ONLY */</span>
<a name="l00881"></a>00881   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a99e986229bd70b2d70118ee67d9e0f3d">Length_High</a> = context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab016a7edf3519fd9ae51c6c5979e8495">Length_Low</a> = 0;
<a name="l00882"></a>00882 #endif <span class="comment">/* USE_32BIT_ONLY */</span>
<a name="l00883"></a>00883   context-&gt;<a class="code" href="struct_s_h_a512_context.html#a8fc7f840bd0ac183cee5dbc05d391918">Computed</a> = 1;
<a name="l00884"></a>00884 }
<a name="l00885"></a>00885 
<a name="l00886"></a>00886 <span class="comment">/*</span>
<a name="l00887"></a>00887 <span class="comment"> * SHA384_512PadMessage</span>
<a name="l00888"></a>00888 <span class="comment"> *</span>
<a name="l00889"></a>00889 <span class="comment"> * Description:</span>
<a name="l00890"></a>00890 <span class="comment"> *   According to the standard, the message must be padded to the next</span>
<a name="l00891"></a>00891 <span class="comment"> *   even multiple of 1024 bits.  The first padding bit must be a &#39;1&#39;.</span>
<a name="l00892"></a>00892 <span class="comment"> *   The last 128 bits represent the length of the original message.</span>
<a name="l00893"></a>00893 <span class="comment"> *   All bits in between should be 0.  This helper function will</span>
<a name="l00894"></a>00894 <span class="comment"> *   pad the message according to those rules by filling the</span>
<a name="l00895"></a>00895 <span class="comment"> *   Message_Block array accordingly.  When it returns, it can be</span>
<a name="l00896"></a>00896 <span class="comment"> *   assumed that the message digest has been computed.</span>
<a name="l00897"></a>00897 <span class="comment"> *</span>
<a name="l00898"></a>00898 <span class="comment"> * Parameters:</span>
<a name="l00899"></a>00899 <span class="comment"> *   context: [in/out]</span>
<a name="l00900"></a>00900 <span class="comment"> *     The context to pad.</span>
<a name="l00901"></a>00901 <span class="comment"> *   Pad_Byte: [in]</span>
<a name="l00902"></a>00902 <span class="comment"> *     The last byte to add to the message block before the 0-padding</span>
<a name="l00903"></a>00903 <span class="comment"> *     and length.  This will contain the last bits of the message</span>
<a name="l00904"></a>00904 <span class="comment"> *     followed by another single bit.  If the message was an</span>
<a name="l00905"></a>00905 <span class="comment"> *     exact multiple of 8-bits long, Pad_Byte will be 0x80.</span>
<a name="l00906"></a>00906 <span class="comment"> *</span>
<a name="l00907"></a>00907 <span class="comment"> * Returns:</span>
<a name="l00908"></a>00908 <span class="comment"> *   Nothing.</span>
<a name="l00909"></a>00909 <span class="comment"> *</span>
<a name="l00910"></a>00910 <span class="comment"> */</span>
<a name="l00911"></a><a class="code" href="sha384-512_8c.html#adb046125a91515d019f7300fce3caf49">00911</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="sha384-512_8c.html#adb046125a91515d019f7300fce3caf49">SHA384_512PadMessage</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00912"></a>00912     uint8_t Pad_Byte)
<a name="l00913"></a>00913 {
<a name="l00914"></a>00914   <span class="comment">/*</span>
<a name="l00915"></a>00915 <span class="comment">   * Check to see if the current message block is too small to hold</span>
<a name="l00916"></a>00916 <span class="comment">   * the initial padding bits and length.  If so, we will pad the</span>
<a name="l00917"></a>00917 <span class="comment">   * block, process it, and then continue padding into a second</span>
<a name="l00918"></a>00918 <span class="comment">   * block.</span>
<a name="l00919"></a>00919 <span class="comment">   */</span>
<a name="l00920"></a>00920   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="struct_s_h_a512_context.html#adb9aaac6288732d941355bfbd45ecd80">Message_Block_Index</a> &gt;= (<a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04abba971af4f20bede9e0e62472e03e755">SHA512_Message_Block_Size</a>-16)) {
<a name="l00921"></a>00921     context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[context-&gt;<a class="code" href="struct_s_h_a512_context.html#adb9aaac6288732d941355bfbd45ecd80">Message_Block_Index</a>++] = Pad_Byte;
<a name="l00922"></a>00922     <span class="keywordflow">while</span> (context-&gt;<a class="code" href="struct_s_h_a512_context.html#adb9aaac6288732d941355bfbd45ecd80">Message_Block_Index</a> &lt; <a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04abba971af4f20bede9e0e62472e03e755">SHA512_Message_Block_Size</a>)
<a name="l00923"></a>00923       context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[context-&gt;<a class="code" href="struct_s_h_a512_context.html#adb9aaac6288732d941355bfbd45ecd80">Message_Block_Index</a>++] = 0;
<a name="l00924"></a>00924 
<a name="l00925"></a>00925     <a class="code" href="sha384-512_8c.html#a39e7956ca292d5d358d2449b58f0034e">SHA384_512ProcessMessageBlock</a>(context);
<a name="l00926"></a>00926   } <span class="keywordflow">else</span>
<a name="l00927"></a>00927     context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[context-&gt;<a class="code" href="struct_s_h_a512_context.html#adb9aaac6288732d941355bfbd45ecd80">Message_Block_Index</a>++] = Pad_Byte;
<a name="l00928"></a>00928 
<a name="l00929"></a>00929   <span class="keywordflow">while</span> (context-&gt;<a class="code" href="struct_s_h_a512_context.html#adb9aaac6288732d941355bfbd45ecd80">Message_Block_Index</a> &lt; (<a class="code" href="sha_8h.html#abc6126af1d45847bc59afa0aa3216b04abba971af4f20bede9e0e62472e03e755">SHA512_Message_Block_Size</a>-16))
<a name="l00930"></a>00930     context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[context-&gt;<a class="code" href="struct_s_h_a512_context.html#adb9aaac6288732d941355bfbd45ecd80">Message_Block_Index</a>++] = 0;
<a name="l00931"></a>00931 
<a name="l00932"></a>00932   <span class="comment">/*</span>
<a name="l00933"></a>00933 <span class="comment">   * Store the message length as the last 16 octets</span>
<a name="l00934"></a>00934 <span class="comment">   */</span>
<a name="l00935"></a>00935 <span class="preprocessor">#ifdef USE_32BIT_ONLY</span>
<a name="l00936"></a>00936 <span class="preprocessor"></span>  context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[112] = (uint8_t)(context-&gt;Length[0] &gt;&gt; 24);
<a name="l00937"></a>00937   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[113] = (uint8_t)(context-&gt;Length[0] &gt;&gt; 16);
<a name="l00938"></a>00938   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[114] = (uint8_t)(context-&gt;Length[0] &gt;&gt; 8);
<a name="l00939"></a>00939   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[115] = (uint8_t)(context-&gt;Length[0]);
<a name="l00940"></a>00940   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[116] = (uint8_t)(context-&gt;Length[1] &gt;&gt; 24);
<a name="l00941"></a>00941   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[117] = (uint8_t)(context-&gt;Length[1] &gt;&gt; 16);
<a name="l00942"></a>00942   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[118] = (uint8_t)(context-&gt;Length[1] &gt;&gt; 8);
<a name="l00943"></a>00943   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[119] = (uint8_t)(context-&gt;Length[1]);
<a name="l00944"></a>00944 
<a name="l00945"></a>00945   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[120] = (uint8_t)(context-&gt;Length[2] &gt;&gt; 24);
<a name="l00946"></a>00946   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[121] = (uint8_t)(context-&gt;Length[2] &gt;&gt; 16);
<a name="l00947"></a>00947   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[122] = (uint8_t)(context-&gt;Length[2] &gt;&gt; 8);
<a name="l00948"></a>00948   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[123] = (uint8_t)(context-&gt;Length[2]);
<a name="l00949"></a>00949   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[124] = (uint8_t)(context-&gt;Length[3] &gt;&gt; 24);
<a name="l00950"></a>00950   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[125] = (uint8_t)(context-&gt;Length[3] &gt;&gt; 16);
<a name="l00951"></a>00951   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[126] = (uint8_t)(context-&gt;Length[3] &gt;&gt; 8);
<a name="l00952"></a>00952   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[127] = (uint8_t)(context-&gt;Length[3]);
<a name="l00953"></a>00953 <span class="preprocessor">#else </span><span class="comment">/* !USE_32BIT_ONLY */</span>
<a name="l00954"></a>00954   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[112] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a99e986229bd70b2d70118ee67d9e0f3d">Length_High</a> &gt;&gt; 56);
<a name="l00955"></a>00955   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[113] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a99e986229bd70b2d70118ee67d9e0f3d">Length_High</a> &gt;&gt; 48);
<a name="l00956"></a>00956   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[114] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a99e986229bd70b2d70118ee67d9e0f3d">Length_High</a> &gt;&gt; 40);
<a name="l00957"></a>00957   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[115] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a99e986229bd70b2d70118ee67d9e0f3d">Length_High</a> &gt;&gt; 32);
<a name="l00958"></a>00958   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[116] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a99e986229bd70b2d70118ee67d9e0f3d">Length_High</a> &gt;&gt; 24);
<a name="l00959"></a>00959   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[117] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a99e986229bd70b2d70118ee67d9e0f3d">Length_High</a> &gt;&gt; 16);
<a name="l00960"></a>00960   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[118] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a99e986229bd70b2d70118ee67d9e0f3d">Length_High</a> &gt;&gt; 8);
<a name="l00961"></a>00961   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[119] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a99e986229bd70b2d70118ee67d9e0f3d">Length_High</a>);
<a name="l00962"></a>00962 
<a name="l00963"></a>00963   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[120] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab016a7edf3519fd9ae51c6c5979e8495">Length_Low</a> &gt;&gt; 56);
<a name="l00964"></a>00964   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[121] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab016a7edf3519fd9ae51c6c5979e8495">Length_Low</a> &gt;&gt; 48);
<a name="l00965"></a>00965   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[122] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab016a7edf3519fd9ae51c6c5979e8495">Length_Low</a> &gt;&gt; 40);
<a name="l00966"></a>00966   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[123] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab016a7edf3519fd9ae51c6c5979e8495">Length_Low</a> &gt;&gt; 32);
<a name="l00967"></a>00967   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[124] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab016a7edf3519fd9ae51c6c5979e8495">Length_Low</a> &gt;&gt; 24);
<a name="l00968"></a>00968   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[125] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab016a7edf3519fd9ae51c6c5979e8495">Length_Low</a> &gt;&gt; 16);
<a name="l00969"></a>00969   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[126] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab016a7edf3519fd9ae51c6c5979e8495">Length_Low</a> &gt;&gt; 8);
<a name="l00970"></a>00970   context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab67d9bc0de04bd080afa9c641ca81383">Message_Block</a>[127] = (uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#ab016a7edf3519fd9ae51c6c5979e8495">Length_Low</a>);
<a name="l00971"></a>00971 <span class="preprocessor">#endif </span><span class="comment">/* USE_32BIT_ONLY */</span>
<a name="l00972"></a>00972 
<a name="l00973"></a>00973   <a class="code" href="sha384-512_8c.html#a39e7956ca292d5d358d2449b58f0034e">SHA384_512ProcessMessageBlock</a>(context);
<a name="l00974"></a>00974 }
<a name="l00975"></a>00975 
<a name="l00976"></a>00976 <span class="comment">/*</span>
<a name="l00977"></a>00977 <span class="comment"> * SHA384_512ResultN</span>
<a name="l00978"></a>00978 <span class="comment"> *</span>
<a name="l00979"></a>00979 <span class="comment"> * Description:</span>
<a name="l00980"></a>00980 <span class="comment"> *   This helper function will return the 384-bit or 512-bit message</span>
<a name="l00981"></a>00981 <span class="comment"> *   digest into the Message_Digest array provided by the caller.</span>
<a name="l00982"></a>00982 <span class="comment"> *   NOTE:</span>
<a name="l00983"></a>00983 <span class="comment"> *    The first octet of hash is stored in the element with index 0,</span>
<a name="l00984"></a>00984 <span class="comment"> *    the last octet of hash in the element with index 47/63.</span>
<a name="l00985"></a>00985 <span class="comment"> *</span>
<a name="l00986"></a>00986 <span class="comment"> * Parameters:</span>
<a name="l00987"></a>00987 <span class="comment"> *   context: [in/out]</span>
<a name="l00988"></a>00988 <span class="comment"> *     The context to use to calculate the SHA hash.</span>
<a name="l00989"></a>00989 <span class="comment"> *   Message_Digest[ ]: [out]</span>
<a name="l00990"></a>00990 <span class="comment"> *     Where the digest is returned.</span>
<a name="l00991"></a>00991 <span class="comment"> *   HashSize: [in]</span>
<a name="l00992"></a>00992 <span class="comment"> *     The size of the hash, either 48 or 64.</span>
<a name="l00993"></a>00993 <span class="comment"> *</span>
<a name="l00994"></a>00994 <span class="comment"> * Returns:</span>
<a name="l00995"></a>00995 <span class="comment"> *   sha Error Code.</span>
<a name="l00996"></a>00996 <span class="comment"> *</span>
<a name="l00997"></a>00997 <span class="comment"> */</span>
<a name="l00998"></a><a class="code" href="sha384-512_8c.html#af90419c2834cbfcd587b990456f992ab">00998</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="sha384-512_8c.html#af90419c2834cbfcd587b990456f992ab">SHA384_512ResultN</a>(<a class="code" href="struct_s_h_a512_context.html">SHA512Context</a> *context,
<a name="l00999"></a>00999     uint8_t Message_Digest[ ], <span class="keywordtype">int</span> HashSize)
<a name="l01000"></a>01000 {
<a name="l01001"></a>01001   <span class="keywordtype">int</span> i;
<a name="l01002"></a>01002 <span class="preprocessor">#ifdef USE_32BIT_ONLY</span>
<a name="l01003"></a>01003 <span class="preprocessor"></span>  <span class="keywordtype">int</span> i2;
<a name="l01004"></a>01004 <span class="preprocessor">#endif </span><span class="comment">/* USE_32BIT_ONLY */</span>
<a name="l01005"></a>01005 
<a name="l01006"></a>01006   <span class="keywordflow">if</span> (!context) <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5ae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;
<a name="l01007"></a>01007   <span class="keywordflow">if</span> (!Message_Digest) <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5ae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;
<a name="l01008"></a>01008   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a>) <span class="keywordflow">return</span> context-&gt;<a class="code" href="struct_s_h_a512_context.html#a6ee1af729b14256d9134eb4c1a04f26f">Corrupted</a>;
<a name="l01009"></a>01009 
<a name="l01010"></a>01010   <span class="keywordflow">if</span> (!context-&gt;<a class="code" href="struct_s_h_a512_context.html#a8fc7f840bd0ac183cee5dbc05d391918">Computed</a>)
<a name="l01011"></a>01011     <a class="code" href="sha384-512_8c.html#a69a2234ba9c2d56a7f4cfdfcfe138936">SHA384_512Finalize</a>(context, 0x80);
<a name="l01012"></a>01012 
<a name="l01013"></a>01013 <span class="preprocessor">#ifdef USE_32BIT_ONLY</span>
<a name="l01014"></a>01014 <span class="preprocessor"></span>  <span class="keywordflow">for</span> (i = i2 = 0; i &lt; HashSize; ) {
<a name="l01015"></a>01015     Message_Digest[i++]=(uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[i2]&gt;&gt;24);
<a name="l01016"></a>01016     Message_Digest[i++]=(uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[i2]&gt;&gt;16);
<a name="l01017"></a>01017     Message_Digest[i++]=(uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[i2]&gt;&gt;8);
<a name="l01018"></a>01018     Message_Digest[i++]=(uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[i2++]);
<a name="l01019"></a>01019     Message_Digest[i++]=(uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[i2]&gt;&gt;24);
<a name="l01020"></a>01020     Message_Digest[i++]=(uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[i2]&gt;&gt;16);
<a name="l01021"></a>01021     Message_Digest[i++]=(uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[i2]&gt;&gt;8);
<a name="l01022"></a>01022     Message_Digest[i++]=(uint8_t)(context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[i2++]);
<a name="l01023"></a>01023   }
<a name="l01024"></a>01024 <span class="preprocessor">#else </span><span class="comment">/* !USE_32BIT_ONLY */</span>
<a name="l01025"></a>01025   <span class="keywordflow">for</span> (i = 0; i &lt; HashSize; ++i)
<a name="l01026"></a>01026     Message_Digest[i] = (uint8_t)
<a name="l01027"></a>01027       (context-&gt;<a class="code" href="struct_s_h_a512_context.html#a41704b50d7c0c9e85618c0bfe3285334">Intermediate_Hash</a>[i&gt;&gt;3] &gt;&gt; 8 * ( 7 - ( i % 8 ) ));
<a name="l01028"></a>01028 <span class="preprocessor">#endif </span><span class="comment">/* USE_32BIT_ONLY */</span>
<a name="l01029"></a>01029 
<a name="l01030"></a>01030   <span class="keywordflow">return</span> <a class="code" href="sha_8h.html#a99fb83031ce9923c84392b4e92f956b5a581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;
<a name="l01031"></a>01031 }
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="sha384-512_8c.html">sha384-512.c</a>      </li>

    <li class="footer">Generated on Wed Feb 20 2013 05:56:08 for libmoost by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
